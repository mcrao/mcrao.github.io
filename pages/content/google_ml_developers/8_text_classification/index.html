<!doctype html><html style="overflow:auto;height:auto;width:auto;"><head><title>8_text_classification</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><style>@font-face {
	font-family: Asana;
	src: url("fonts/Asana-Math.otf") format("opentype");
}

@font-face {
	font-family: Asana-Math;
	src: url("fonts/Asana-math-mode.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathit;
	src: url("fonts/types-generated/Asana-mathit.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: 'FontAwesome';
	src: url('fonts/icomoon.eot');
	src: url('fonts/icomoon.eot') format('embedded-opentype'), url('fonts/icomoon.woff') format('woff'), url('fonts/icomoon.ttf') format('truetype'), url('fonts/icomoon.svg') format('svg');
	font-weight: normal;
	font-style: normal;
}

/**
Latin Modern
**/

@font-face {
	font-family: LatinModern;
	src: url("fonts/latinmodern-math.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Math;
	src: url("fonts/latinmodern-math-mode.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathbb;
	src: url("fonts/types-generated/latinmodern-mathbb.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathit;
	src: url("fonts/types-generated/latinmodern-mathit.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathcal;
	src: url("fonts/types-generated/latinmodern-mathcal.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathscr;
	src: url("fonts/types-generated/latinmodern-mathscr.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathfrak;
	src: url("fonts/types-generated/latinmodern-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathsf;
	src: url("fonts/types-generated/latinmodern-mathsf.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathtt;
	src: url("fonts/types-generated/latinmodern-mathtt.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathrm;
	src: url("fonts/types-generated/latinmodern-mathrm.otf") format("opentype");
}

/***********************************************************/

/**
Thicker Latin Modern
**/

@font-face {
	font-family: ThickerLm;
	src: url("fonts/thickerlm-math.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Math;
	src: url("fonts/thickerlm-math-mode.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathbb;
	src: url("fonts/types-generated/thickerlm-mathbb.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathit;
	src: url("fonts/types-generated/thickerlm-mathit.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathcal;
	src: url("fonts/types-generated/thickerlm-mathcal.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathscr;
	src: url("fonts/types-generated/thickerlm-mathscr.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathfrak;
	src: url("fonts/types-generated/thickerlm-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathsf;
	src: url("fonts/types-generated/thickerlm-mathsf.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathtt;
	src: url("fonts/types-generated/thickerlm-mathtt.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathrm;
	src: url("fonts/types-generated/thickerlm-mathrm.otf") format("opentype");
}

/***********************************************************/

/* Computer Modern */

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunss.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsi.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunso.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunrm.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunti.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbi.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntt.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntb.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmunit.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntx.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

/**/

/**
Sans Math + Liberation Font
**/

@font-face {
	font-family: Sans;
	src: url("fonts/Sans-Math.otf") format("opentype");
}

@font-face {
	font-family: Sans-Math;
	src: url("fonts/Sans-Math-mode.otf") format("opentype");
}

@font-face {
	font-family: Sans-Bold;
	src: url("fonts/types-generated/Sans-bold.otf") format("opentype");
	font-weight: bold;
}

@font-face {
	font-family: Sans-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathit;
	src: url("fonts/types-generated/Sans-mathit.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathbf;
	src: url("fonts/types-generated/Sans-mathbf.otf") format("opentype");
	font-weight: bold;
}

/***********************************************************/</style><style>/* @font-face {
  font-family: 'FontAwesome';
  src: format('woff'), url('fonts/icomoon.svg?erlpdm#icomoon') format('svg');
  font-weight: normal;
  font-style: normal;
} */

[class^="fa-"], [class*=" fa-"] {
  /* use !important to prevent issues with browser extensions that change fonts */
  /* font-family: 'FontAwesome' !important;
  speak: none;
  font-style: normal;
  font-weight: normal;
  font-variant: normal;
  text-transform: none; */
  /* line-height: 1; */
  /* Better Font Rendering =========== */
  /* -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale; */
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.fa-plus:before {
  content: "\f067";
}
.fa-user:before {
  content: "\f007";
}
.fa-check:before {
  content: "\f00c";
}
.fa-close:before {
  content: "\f00d";
}
.fa-remove:before {
  content: "\f00d";
}
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-cog:before {
  content: "\f013";
}
.fa-gear:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-dedent:before {
  content: "\f03b";
}
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-image:before {
  content: "\f03e";
}
.fa-photo:before {
  content: "\f03e";
}
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-edit:before {
  content: "\f044";
}
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before {
  content: "\f064";
}
.fa-share:before {
  content: "\f064";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-warning:before {
  content: "\f071";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-twr:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-fce:before {
  content: "\f09a";
}
.fa-facebook-f:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-gh:before {
  content: "\f09b";
}
.fa-cut:before {
  content: "\f0c4";
}
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before {
  content: "\f0c5";
}
.fa-files-o:before {
  content: "\f0c5";
}
.fa-bars:before {
  content: "\f0c9";
}
.fa-navicon:before {
  content: "\f0c9";
}
.fa-reorder:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-down:before {
  content: "\f0dd";
}
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-paste:before {
  content: "\f0ea";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before {
  content: "\f112";
}
.fa-reply:before {
  content: "\f112";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-gg:before {
  content: "\f1a0";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-stop-o:before {
  content: "\f256";
}
</style><style>

compositeblock {
  display: inline-block;
  position: relative;
  text-align: left;
  unicode-bidi: isolate;
}
compositeblock.middle {
  vertical-align: middle;
}
latex-symbol-icon {
  display: inline-block;
  padding: 2px;
  border: 1px solid transparent;
  cursor: pointer;
}
latex-symbol-icon:hover,
latex-symbol-icon.selected {
  background: white;
  border: 1px solid lightgray;
}
inline {
  display: inline-block;
}
base-line-indicator {
  display: inline-block;
  overflow: hidden;
  width: 0px;
  height: inherit;
}

math-type .constant-text > constant-text {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .constant-text > constant-text.close-left {
  margin-left: 0;
}
math-type .constant-text > constant-text.close-right {
  margin-right: 0;
}



/**different context*/
/**different context*/
math-type ref-tag {
  position: absolute;
  right: 5px;
  top: 50%;
  transform: translate(0, -50%);
  z-index: 8;
  cursor: pointer;
}
math-type ref-tag > label {
  cursor: pointer;
}
math-type ref-tag:hover {
  text-decoration: underline;
}
math-type ref-tag.line-tag {
  transition: background 0.4s;
}
math-type ref-tag.empty-line-tag {
  opacity: 0.5;
  animation: fadein 0.5s;
}
math-type tr.math-row ref-tag {
  left: calc(100% + 20px);
  right: unset;
}
@keyframes fadein {
  0% {
    opacity: 0;
  }
  70% {
    opacity: 0;
  }
  100% {
    opacity: 0.5;
  }
}







.color-picker no-color-select {
  display: block;
  text-align: center;
  /* width: 100%; */
  /* height: 20px; */
  background: white;
  border: 1px solid lightgray;
  margin-bottom: 2px;
  color: gray;
  padding: 2px;
  cursor: default;
  border-radius: 0;
  padding-bottom: 2px;
  margin-bottom: 3px;
  margin-left: -1px;
  margin-right: -1px;
  font-size: 13px;
}
.color-picker no-color-select:hover {
  color: black;
}
.color-picker color-select {
  position: absolute;
  top: 30px;
  left: 0px;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type editarea.no-area-container,
math-type editarea.text-mode,
math-type area-container,
math-type .print-as-area-container {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
math-type editarea.no-area-container > line,
math-type editarea.text-mode > line,
math-type area-container > line,
math-type .print-as-area-container > line {
  min-width: 0.3em;
  position: relative;
  display: block;
  width: 100%;
  align-items: baseline;
  flex-wrap: wrap;
  box-sizing: border-box;
  flex-wrap: nowrap;
  line-height: 1.2;
  white-space: nowrap;
}
math-type editarea.no-area-container > line block,
math-type editarea.text-mode > line block,
math-type area-container > line block,
math-type .print-as-area-container > line block {
  white-space: pre;
}
math-type editarea.no-area-container > line.single-block > blocks > baselineblock,
math-type editarea.text-mode > line.single-block > blocks > baselineblock,
math-type area-container > line.single-block > blocks > baselineblock,
math-type .print-as-area-container > line.single-block > blocks > baselineblock {
  display: none;
}
math-type editarea.no-area-container > line > blocks,
math-type editarea.text-mode > line > blocks,
math-type area-container > line > blocks,
math-type .print-as-area-container > line > blocks {
  /**
            Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
            */
  display: inline-block;
  text-align: left;
}
math-type editarea.no-area-container > line.root,
math-type editarea.text-mode > line.root,
math-type area-container > line.root,
math-type .print-as-area-container > line.root,
math-type editarea.no-area-container > line.text-mode,
math-type editarea.text-mode > line.text-mode,
math-type area-container > line.text-mode,
math-type .print-as-area-container > line.text-mode {
  display: block;
  font-style: normal;
}
math-type editarea.no-area-container > line.root > prefix,
math-type editarea.text-mode > line.root > prefix,
math-type area-container > line.root > prefix,
math-type .print-as-area-container > line.root > prefix,
math-type editarea.no-area-container > line.text-mode > prefix,
math-type editarea.text-mode > line.text-mode > prefix,
math-type area-container > line.text-mode > prefix,
math-type .print-as-area-container > line.text-mode > prefix {
  white-space: pre;
  display: inline-block;
  cursor: default;
  text-align: left;
}
math-type editarea.no-area-container > line.root > blocks,
math-type editarea.text-mode > line.root > blocks,
math-type area-container > line.root > blocks,
math-type .print-as-area-container > line.root > blocks,
math-type editarea.no-area-container > line.text-mode > blocks,
math-type editarea.text-mode > line.text-mode > blocks,
math-type area-container > line.text-mode > blocks,
math-type .print-as-area-container > line.text-mode > blocks {
  /** should not wrap here*/
  align-items: baseline;
  box-sizing: border-box;
}
math-type editarea.no-area-container > line.root > blocks > block,
math-type editarea.text-mode > line.root > blocks > block,
math-type area-container > line.root > blocks > block,
math-type .print-as-area-container > line.root > blocks > block,
math-type editarea.no-area-container > line.text-mode > blocks > block,
math-type editarea.text-mode > line.text-mode > blocks > block,
math-type area-container > line.text-mode > blocks > block,
math-type .print-as-area-container > line.text-mode > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.text-mode > line.root.full-line-block-inside > prefix,
math-type area-container > line.root.full-line-block-inside > prefix,
math-type .print-as-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > prefix,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > prefix,
math-type area-container > line.text-mode.full-line-block-inside > prefix,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > prefix {
  float: left;
  vertical-align: top;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks,
math-type area-container > line.root.full-line-block-inside > blocks,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks,
math-type area-container > line.text-mode.full-line-block-inside > blocks,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks {
  display: block;
  width: 100%;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock {
  display: inline-block;
  float: left;
}
math-type editarea.no-area-container > line.root.has-rtl.align-justify,
math-type editarea.text-mode > line.root.has-rtl.align-justify,
math-type area-container > line.root.has-rtl.align-justify,
math-type .print-as-area-container > line.root.has-rtl.align-justify,
math-type editarea.no-area-container > line.text-mode.has-rtl.align-justify,
math-type editarea.text-mode > line.text-mode.has-rtl.align-justify,
math-type area-container > line.text-mode.has-rtl.align-justify,
math-type .print-as-area-container > line.text-mode.has-rtl.align-justify {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section,
math-type editarea.text-mode > line.root.section,
math-type area-container > line.root.section,
math-type .print-as-area-container > line.root.section,
math-type editarea.no-area-container > line.text-mode.section,
math-type editarea.text-mode > line.text-mode.section,
math-type area-container > line.text-mode.section,
math-type .print-as-area-container > line.text-mode.section {
  text-align: left;
}
math-type editarea.no-area-container > line.root.section > blocks,
math-type editarea.text-mode > line.root.section > blocks,
math-type area-container > line.root.section > blocks,
math-type .print-as-area-container > line.root.section > blocks,
math-type editarea.no-area-container > line.text-mode.section > blocks,
math-type editarea.text-mode > line.text-mode.section > blocks,
math-type area-container > line.text-mode.section > blocks,
math-type .print-as-area-container > line.text-mode.section > blocks {
  /**
                    Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
                    */
  display: inline;
}
math-type editarea.no-area-container > line.root.section.has-rtl,
math-type editarea.text-mode > line.root.section.has-rtl,
math-type area-container > line.root.section.has-rtl,
math-type .print-as-area-container > line.root.section.has-rtl,
math-type editarea.no-area-container > line.text-mode.section.has-rtl,
math-type editarea.text-mode > line.text-mode.section.has-rtl,
math-type area-container > line.text-mode.section.has-rtl,
math-type .print-as-area-container > line.text-mode.section.has-rtl {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section.has-rtl > prefix,
math-type editarea.text-mode > line.root.section.has-rtl > prefix,
math-type area-container > line.root.section.has-rtl > prefix,
math-type .print-as-area-container > line.root.section.has-rtl > prefix,
math-type editarea.no-area-container > line.text-mode.section.has-rtl > prefix,
math-type editarea.text-mode > line.text-mode.section.has-rtl > prefix,
math-type area-container > line.text-mode.section.has-rtl > prefix,
math-type .print-as-area-container > line.text-mode.section.has-rtl > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.root.theorem,
math-type editarea.text-mode > line.root.theorem,
math-type area-container > line.root.theorem,
math-type .print-as-area-container > line.root.theorem,
math-type editarea.no-area-container > line.text-mode.theorem,
math-type editarea.text-mode > line.text-mode.theorem,
math-type area-container > line.text-mode.theorem,
math-type .print-as-area-container > line.text-mode.theorem {
  padding-top: 0.3em;
  padding-bottom: 0.3em;
}
math-type editarea.no-area-container > line > prefix,
math-type editarea.text-mode > line > prefix,
math-type area-container > line > prefix,
math-type .print-as-area-container > line > prefix {
  text-align: right;
}
math-type editarea.no-area-container > line.has-indent,
math-type editarea.text-mode > line.has-indent,
math-type area-container > line.has-indent,
math-type .print-as-area-container > line.has-indent {
  display: flex;
  justify-content: flex-start;
}
math-type editarea.no-area-container > line.has-rtl.has-indent > prefix,
math-type editarea.text-mode > line.has-rtl.has-indent > prefix,
math-type area-container > line.has-rtl.has-indent > prefix,
math-type .print-as-area-container > line.has-rtl.has-indent > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-0,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-0,
math-type area-container > line.has-rtl.has-indent.indent-0,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-0 {
  padding-left: 0;
  padding-right: 30px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-1,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-1,
math-type area-container > line.has-rtl.has-indent.indent-1,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-1 {
  padding-left: 0;
  padding-right: 65px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-2,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-2,
math-type area-container > line.has-rtl.has-indent.indent-2,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-2 {
  padding-left: 0;
  padding-right: 105px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-3,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-3,
math-type area-container > line.has-rtl.has-indent.indent-3,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-3 {
  padding-left: 0;
  padding-right: 145px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-4,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-4,
math-type area-container > line.has-rtl.has-indent.indent-4,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-4 {
  padding-left: 0;
  padding-right: 185px;
}
math-type editarea.no-area-container > line.indent-0,
math-type editarea.text-mode > line.indent-0,
math-type area-container > line.indent-0,
math-type .print-as-area-container > line.indent-0 {
  padding-left: 30px;
}
math-type editarea.no-area-container > line.indent-1,
math-type editarea.text-mode > line.indent-1,
math-type area-container > line.indent-1,
math-type .print-as-area-container > line.indent-1 {
  padding-left: 65px;
}
math-type editarea.no-area-container > line.indent-2,
math-type editarea.text-mode > line.indent-2,
math-type area-container > line.indent-2,
math-type .print-as-area-container > line.indent-2 {
  padding-left: 105px;
}
math-type editarea.no-area-container > line.indent-3,
math-type editarea.text-mode > line.indent-3,
math-type area-container > line.indent-3,
math-type .print-as-area-container > line.indent-3 {
  padding-left: 145px;
}
math-type editarea.no-area-container > line.indent-4,
math-type editarea.text-mode > line.indent-4,
math-type area-container > line.indent-4,
math-type .print-as-area-container > line.indent-4 {
  padding-left: 185px;
}
math-type editarea.no-area-container > line.math-container-selected,
math-type editarea.text-mode > line.math-container-selected,
math-type area-container > line.math-container-selected,
math-type .print-as-area-container > line.math-container-selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.no-area-container > line.math-container,
math-type editarea.text-mode > line.math-container,
math-type area-container > line.math-container,
math-type .print-as-area-container > line.math-container {
  font-family: 'Asana';
  justify-content: center;
  text-align: center;
  text-align-last: auto;
  display: flex;
}
math-type editarea.no-area-container > line.math-container block,
math-type editarea.text-mode > line.math-container block,
math-type area-container > line.math-container block,
math-type .print-as-area-container > line.math-container block {
  white-space: pre;
}
math-type editarea.no-area-container > line.align-center,
math-type editarea.text-mode > line.align-center,
math-type area-container > line.align-center,
math-type .print-as-area-container > line.align-center {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center.has-indent,
math-type editarea.text-mode > line.align-center.has-indent,
math-type area-container > line.align-center.has-indent,
math-type .print-as-area-container > line.align-center.has-indent {
  justify-content: center;
}
math-type editarea.no-area-container > line.align-center.section,
math-type editarea.text-mode > line.align-center.section,
math-type area-container > line.align-center.section,
math-type .print-as-area-container > line.align-center.section {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center > blocks,
math-type editarea.text-mode > line.align-center > blocks,
math-type area-container > line.align-center > blocks,
math-type .print-as-area-container > line.align-center > blocks {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-justify,
math-type editarea.text-mode > line.align-justify,
math-type area-container > line.align-justify,
math-type .print-as-area-container > line.align-justify {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify.section,
math-type editarea.text-mode > line.align-justify.section,
math-type area-container > line.align-justify.section,
math-type .print-as-area-container > line.align-justify.section {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify > blocks,
math-type editarea.text-mode > line.align-justify > blocks,
math-type area-container > line.align-justify > blocks,
math-type .print-as-area-container > line.align-justify > blocks {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-left,
math-type editarea.text-mode > line.align-left,
math-type area-container > line.align-left,
math-type .print-as-area-container > line.align-left {
  text-align: left;
}
math-type editarea.no-area-container > line.align-left > blocks,
math-type editarea.text-mode > line.align-left > blocks,
math-type area-container > line.align-left > blocks,
math-type .print-as-area-container > line.align-left > blocks {
  text-align: left;
}
math-type editarea.no-area-container > line.align-right,
math-type editarea.text-mode > line.align-right,
math-type area-container > line.align-right,
math-type .print-as-area-container > line.align-right {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right.has-indent,
math-type editarea.text-mode > line.align-right.has-indent,
math-type area-container > line.align-right.has-indent,
math-type .print-as-area-container > line.align-right.has-indent {
  justify-content: flex-end;
}
math-type editarea.no-area-container > line.align-right.section,
math-type editarea.text-mode > line.align-right.section,
math-type area-container > line.align-right.section,
math-type .print-as-area-container > line.align-right.section {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right > blocks,
math-type editarea.text-mode > line.align-right > blocks,
math-type area-container > line.align-right > blocks,
math-type .print-as-area-container > line.align-right > blocks {
  text-align: right;
}
math-type editarea.no-area-container > line > blocks > block,
math-type editarea.text-mode > line > blocks > block,
math-type area-container > line > blocks > block,
math-type .print-as-area-container > line > blocks > block {
  display: inline;
}
math-type editarea.no-area-container,
math-type area-container {
  align-items: initial;
}
math-type editarea.root-editor {
  align-items: initial;
  display: block;
  color: black;
  fill: black;
  stroke: black;
  border-color: black;
}
math-type editarea.root-editor.read-only {
  cursor: default;
}
math-type editarea.root-editor.read-only block {
  cursor: default;
}
math-type editarea.root-editor > area-container {
  display: block;
}
math-type area-container {
  width: 100%;
}
math-type block {
  cursor: text;
}
math-type editarea {
  box-sizing: border-box;
  display: flex;
  overflow-x: visible;
  align-items: center;
  justify-content: center;
  flex-direction: row;
  flex-wrap: nowrap;
}
math-type editarea block {
  cursor: text;
}
math-type editarea.high-order {
  position: relative;
  z-index: 10;
}
math-type editarea.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.bordered {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.center > area-container > line,
math-type editarea.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type editarea.left > area-container > line,
math-type editarea.left > line {
  justify-content: flex-start;
  text-align: left;
}
math-type editarea.right > area-container > line,
math-type editarea.right > line {
  justify-content: flex-end;
  text-align: right;
}
math-type editarea > area-baseline {
  width: 0;
  overflow: hidden;
  display: inline-block;
  float: left;
}
math-type setting.mt-common-dialog.line-tag-setting {
  transform: translate(0, -100%);
  position: absolute;
  font-family: serif;
  font-size: 11px;
  top: -4px;
  left: -10px;
  outline: none;
}
math-type setting.mt-common-dialog.line-tag-setting i {
  font-style: normal;
  padding: 1px 3px;
}
baselineblock {
  height: 0px;
  display: inline-block;
  width: 0;
  overflow: hidden;
}
baselineblock.inline {
  display: inline;
}
emptyblock {
  white-space: pre;
}
composite {
  display: inline-block;
}
block.Binary {
  padding: 0 0.2em;
}
block.Relation {
  padding: 0 0.3em;
}
block.Punctuation {
  padding-right: 0.2em;
}




check-box-wrapper {
  display: block;
  font-size: 11px;
  color: gray;
  cursor: pointer;
}
check-box-wrapper.disabled {
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect {
  border: 1px solid #e2e1e1;
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect:hover {
  border: 1px solid #e2e1e1;
}
check-box-wrapper.mobile-tablet check-box-rect {
  margin-top: -3px;
  width: 16px;
  height: 15px;
  font-size: 13px;
}
check-box-wrapper.mobile-tablet check-box-rect > i {
  left: 2px;
  top: 1px;
}
check-box-wrapper check-box-rect {
  width: 1.4em;
  height: 1.35em;
  border: 1px solid #c3c2c2;
  position: relative;
  display: inline-flex;
  font-size: 11px;
  color: green;
  background: white;
  justify-content: center;
  align-items: center;
}
check-box-wrapper check-box-rect:hover {
  border: 1px solid gray;
}
check-box-wrapper.unchecked check-box-rect > i {
  visibility: hidden;
}

vcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
  flex-direction: column;
}
vcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle-center {
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  position: relative;
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
vcomposed-symbol > middle > fixed > inside {
  display: block;
  overflow: hidden;
}
vcomposed-symbol > end {
  margin-top: -0.02em;
  display: block;
  overflow: hidden;
}


.open-brace,
.close-brace {
  padding: 0 0.1em;
  width: 0.5em;
  min-width: 0.5em;
}
.open-brace > start,
.close-brace > start {
  min-height: 0.75em;
  height: 0.75em;
}
.open-brace > middle-center,
.close-brace > middle-center {
  min-height: 0.6em;
  height: 0.6em;
}
.open-brace > end,
.close-brace > end {
  min-height: 0.75em;
  height: 0.75em;
}
.open-bracket,
.close-bracket {
  width: 0.43em;
  min-width: 0.43em;
}
.open-bracket > start,
.close-bracket > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-bracket > end,
.close-bracket > end {
  height: 0.7em;
  min-height: 0.7em;
}
.open-parenthesis,
.close-parenthesis {
  width: 0.45em;
  min-width: 0.45em;
}
.open-parenthesis > start,
.close-parenthesis > start {
  min-height: 0.85em;
  height: 0.85em;
}
.open-parenthesis > end,
.close-parenthesis > end {
  min-height: 0.8em;
  height: 0.8em;
}
.open-floor,
.close-floor {
  width: 0.45em;
  min-width: 0.45em;
}
.open-floor > end,
.close-floor > end {
  height: 0.35em;
  min-height: 0.35em;
}
.open-ceil,
.close-ceil {
  width: 0.45em;
  min-width: 0.45em;
}
.open-ceil > start,
.close-ceil > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-vert,
.close-vert {
  width: 0.3em;
  min-width: 0.3em;
}
.open-Vert,
.close-Vert {
  width: 0.5em;
  min-width: 0.5em;
}
.open-uparrow,
.close-uparrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-uparrow > start,
.close-uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-downarrow,
.close-downarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-downarrow > end,
.close-downarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-updownarrow,
.close-updownarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-updownarrow > start,
.close-updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-updownarrow > end,
.close-updownarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-Uparrow,
.close-Uparrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Uparrow > start,
.close-Uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Downarrow,
.close-Downarrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Downarrow > end,
.close-Downarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow,
.close-Updownarrow {
  width: 0.6em;
  min-width: 0.6em;
}
.open-Updownarrow > start,
.close-Updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow > end,
.close-Updownarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
opensymbolblock,
closesymbolblock,
.middle-vert-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  text-align: left;
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}
opensymbolblock.normal,
closesymbolblock.normal,
.middle-vert-symbol.normal {
  margin-top: 0;
  margin-bottom: 0;
}
opensymbolblock > hidden-span,
closesymbolblock > hidden-span,
.middle-vert-symbol > hidden-span {
  visibility: hidden;
  width: 0px;
}
opensymbolblock[type='brace'],
closesymbolblock[type='brace'],
.middle-vert-symbol[type='brace'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
  overflow: visible;
}
opensymbolblock[type='brace'] > svg,
closesymbolblock[type='brace'] > svg,
.middle-vert-symbol[type='brace'] > svg {
  overflow: visible;
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
closesymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='bracket'] > svg,
closesymbolblock[type='bracket'] > svg,
.middle-vert-symbol[type='bracket'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='angle'].sm-1 > svg,
closesymbolblock[type='angle'].sm-1 > svg,
.middle-vert-symbol[type='angle'].sm-1 > svg {
  width: 0.3em;
}
opensymbolblock[type='angle'].sm-2 > svg,
closesymbolblock[type='angle'].sm-2 > svg,
.middle-vert-symbol[type='angle'].sm-2 > svg {
  width: 0.45em;
}
opensymbolblock[type='angle'] > svg,
closesymbolblock[type='angle'] > svg,
.middle-vert-symbol[type='angle'] > svg {
  width: 0.6em;
  height: 100%;
}
opensymbolblock[type='slash'] > svg,
closesymbolblock[type='slash'] > svg,
.middle-vert-symbol[type='slash'] > svg {
  width: 0.7em;
  height: 100%;
}
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  display: block;
}
opensymbolblock > vcomposed-symbol,
closesymbolblock > vcomposed-symbol,
.middle-vert-symbol > vcomposed-symbol,
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  height: 100%;
  width: 100%;
  font-style: normal;
}
opensymbolblock > brace-span,
closesymbolblock > brace-span,
.middle-vert-symbol > brace-span {
  visibility: hidden;
  display: inline-block;
  padding: 0 0.1em;
}
opensymbolblock,
.middle-vert-symbol {
  margin-left: 0.07em;
}
opensymbolblock.normal,
.middle-vert-symbol.normal {
  margin-left: 0;
}
opensymbolblock[type='vert'],
.middle-vert-symbol[type='vert'],
opensymbolblock.middle-vert-symbol,
.middle-vert-symbol.middle-vert-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
opensymbolblock[type='vert'] > svg,
.middle-vert-symbol[type='vert'] > svg,
opensymbolblock.middle-vert-symbol > svg,
.middle-vert-symbol.middle-vert-symbol > svg {
  width: 0.4em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  margin-right: -0.1em;
}
closesymbolblock {
  margin-right: 0.07em;
}
closesymbolblock.normal {
  margin-right: 0;
}
closesymbolblock[type='vert'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
closesymbolblock[type='vert'] > svg {
  width: 0.4em;
  height: 100%;
}
closesymbolblock[type='parenthesis'] > svg {
  margin-left: -0.1em;
}

opensymbolblock[type=empty] > empty,
closesymbolblock[type=empty] > empty {
  width: 2px;
  height: 100%;
  display: block;
}
opensymbolblock[type=empty] > empty.normal-size,
closesymbolblock[type=empty] > empty.normal-size {
  height: 1em;
}
opensymbolblock[type=empty] > empty.line-selected,
closesymbolblock[type=empty] > empty.line-selected {
  background-color: lightgray;
}

.dirac-bracket-symbol > div > .oangle,
.dirac-bracket-symbol > div > .cangle {
  align-self: stretch;
  width: 0.55em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .oangle > svg,
.dirac-bracket-symbol > div > .cangle > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > .vert {
  align-self: stretch;
  width: 0.25em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .vert > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > editarea.first {
  min-width: 0.3em;
  padding-right: 0.1em;
}
.dirac-bracket-symbol > div > editarea.last {
  min-width: 0.3em;
  padding-left: 0.1em;
}
.dirac-bracket-symbol > div > editarea.middle {
  min-width: 0.3em;
  padding-left: 0.1em;
  padding-right: 0.1em;
}

cancel-symbol > editarea {
  display: inline-flex;
}
cancel-symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.frac-slashed-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol {
  margin-left: 0.1em;
  margin-right: 0.1em;
  vertical-align: baseline;
}
math-type compositeblock.fraction-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol > .enumerator {
  float: left;
  width: 100%;
  clear: both;
}
math-type compositeblock.fraction-symbol > .denominator {
  margin-top: -5px;
  float: left;
  width: 100%;
}
math-type compositeblock.fraction-symbol > .frac-line {
  clear: both;
  pointer-events: none;
}
math-type compositeblock.fraction-symbol > .frac-line > inline {
  display: inline-block;
  width: 100%;
  vertical-align: 0.25em;
  border-bottom: solid 1px;
}
math-type compositeblock.fraction-symbol > editarea {
  border: 0px;
  min-width: 0.6em;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea > area-container > line,
math-type compositeblock.fraction-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea-line {
  text-align: center;
  text-align-last: auto;
}

.stackrel-icon {
  margin: auto;
  display: flex;
  align-items: center;
  flex-direction: column;
}
.stackrel-icon .square {
  width: 6px;
  height: 6px;
  border-style: solid;
  border-width: 1px;
  border-color: gray;
}
.stackrel-icon .distance {
  margin-top: 3px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .stackrel-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .stackrel-symbol > .cur-value {
  clear: both;
  display: inline-flex;
  width: 100%;
}
math-type .stackrel-symbol > .top {
  float: left;
  clear: both;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .underset-symbol > .center {
  display: inline-flex;
  width: 100%;
}
math-type .underset-symbol > .bottom {
  float: left;
  display: block;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-under-set-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .over-under-set-symbol > .top {
  display: flex;
  float: left;
  clear: both;
  width: 100%;
}
math-type .over-under-set-symbol > .top > line {
  font-size: 0.7em;
}
math-type .over-under-set-symbol > .middle {
  display: inline-flex;
  width: 100%;
  clear: both;
}
math-type .over-under-set-symbol > .middle.select {
  border-bottom: none;
}
math-type .over-under-set-symbol > .bottom {
  display: flex;
  float: left;
  width: 100%;
}
math-type .over-under-set-symbol > .bottom > line {
  font-size: 0.7em;
}

expandable-component.thickness item-option.thickness-option {
  width: 40px;
  height: 12px;
}
expandable-component.thickness svg {
  stroke: gray;
  stroke-width: 1px;
  fill: none;
}
expandable-component.thickness thickness {
  position: relative;
  display: flex;
  height: 100%;
}
expandable-component.thickness thickness > svg.thickness {
  width: 25px;
  height: 100%;
  position: static;
}
expandable-component.thickness thickness > svg.thickness line {
  stroke: gray;
  stroke-width: 1px;
}
expandable-component.thickness thickness > svg.thickness path {
  fill: #d2cfcf;
  stroke: none;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .textcircled > div > editarea {
  text-align: center;
  text-align-last: auto;
}
math-type .textcircled > div > editarea > area-container > line,
math-type .textcircled > div > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol {
  margin-top: 0.3em;
  margin-bottom: 0.3em;
  display: inline-flex;
}
.math-container-symbol.inline {
  margin-top: 0px;
  margin-bottom: 0px;
}
.math-container-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: 1px solid #c1d4c1;
}
.math-container-symbol.display {
  display: block;
}
.math-container-symbol.display.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: none;
}
.math-container-symbol.display > editarea {
  width: 100%;
  flex-grow: 1;
  display: block;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line,
.math-container-symbol.display > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line {
  padding-top: 8px;
  padding-bottom: 8px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol > editarea.multiline {
  display: block;
  flex-grow: 1;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > area-container > line,
.math-container-symbol > editarea.multiline > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > line:last-child {
  justify-content: flex-end;
  text-align: right;
}
.math-container-symbol > editarea.multiline > line:first-child {
  justify-content: flex-start;
  text-align: left;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .icon-sqrt,
.auto-complete-external-area .icon-sqrt {
  display: flex;
  margin: auto;
  font-size: 12px;
}
math-type .icon-sqrt .square,
.auto-complete-external-area .icon-sqrt .square {
  margin-top: 3px;
  margin-right: -6px;
}
math-type .icon-sqrt .square-expand,
.auto-complete-external-area .icon-sqrt .square-expand {
  background-color: #f7f7f7;
}
math-type .icon-sqrt .align-end,
.auto-complete-external-area .icon-sqrt .align-end {
  margin-top: 8px;
}
math-type .icon-sqrt .line,
.auto-complete-external-area .icon-sqrt .line {
  width: 10px;
  border-top: solid 1px black;
  margin-top: 6px;
}
math-type .icon-sqrt .big-square,
.auto-complete-external-area .icon-sqrt .big-square {
  margin-top: 11px;
  margin-left: -8px;
}
math-type .sqrt-symbol {
  white-space: nowrap;
  align-items: stretch;
  position: relative;
}
math-type .sqrt-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  left: 50%;
  top: -0.5em;
  left: 0.5em;
}
math-type .sqrt-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .sqrt-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .sqrt-symbol text {
  fill: black;
}
math-type .sqrt-symbol > sqrt-edit {
  position: relative;
  order: 3;
  display: inline-block;
  align-self: flex-end;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line {
  overflow: visible;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line > svg {
  overflow: visible;
  width: 100%;
  height: 1em;
}
math-type .sqrt-symbol > sqrt-edit > area-container > line {
  width: 1em;
  position: relative;
}
math-type .sqrt-symbol > sqrt-edit > editarea,
math-type .sqrt-symbol > sqrt-edit > editarea-line {
  z-index: 2;
  display: inline-block;
  min-width: 0.5em;
  margin-left: 1em;
}
math-type .sqrt-symbol > sqrt-top {
  position: relative;
  z-index: 2;
  vertical-align: bottom;
  padding-bottom: 0.95em;
  align-self: flex-end;
  display: inline-block;
}
math-type .sqrt-symbol > sqrt-top.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .sqrt-symbol > sqrt-top > editarea {
  font-size: 0.7em;
  border: none 0px;
  min-width: 0.5em;
  display: flex;
  float: right;
  text-align: center;
  text-align-last: auto;
}
math-type .sqrt-symbol > sqrt-top > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
image-viewer {
  width: 100%;
}
image-viewer.inline {
  width: auto;
}
image-viewer .image-content {
  cursor: pointer;
  text-align: left;
}
image-viewer detail list-items-options div {
  border: 1px solid transparent;
  cursor: pointer;
  margin-left: 3px;
  padding: 0 2px 0 2px;
}
image-viewer detail list-items-options div:hover {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer detail list-items-options div.selected {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer image-container {
  display: flex;
  flex-direction: column;
}
image-viewer image-container img {
  position: absolute;
}
image-viewer image-container.center {
  align-items: center;
}
image-viewer image-container.left {
  align-items: flex-start;
}
image-viewer image-container.right {
  align-items: flex-end;
}
.resize-box {
  position: absolute;
  width: 8px;
  height: 8px;
  border-width: 1px;
  border-color: gray;
  border-style: solid;
  background-color: white;
  z-index: 999;
}
.resize-box.mobile-tablet {
  width: 16px;
  height: 16px;
}
.resize-box.hide {
  display: none;
}
topleft {
  top: 0;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: nwse-resize;
}
topleft.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
topright {
  top: 0;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: nesw-resize;
}
topright.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
topmiddle {
  top: 0;
  left: 50%;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ns-resize;
}
topmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
leftmiddle {
  top: 50%;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
leftmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
rightmiddle {
  top: 50%;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
rightmiddle.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
bottomleft {
  bottom: 0;
  left: 0;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: nesw-resize;
}
bottomleft.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
bottomright {
  bottom: 0;
  right: 0;
  margin-right: -5px;
  margin-bottom: -5px;
  cursor: nwse-resize;
}
bottomright.mobile-tablet {
  margin-right: -8px;
  margin-bottom: -8px;
}
bottommiddle {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: ns-resize;
}
bottommiddle.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
.ghost-viewer {
  outline: 1px dotted gray;
  width: 100%;
  height: 100%;
  display: block;
}

compositeblock.image-container {
  position: relative;
  width: 100%;
  margin-top: 10px;
  margin-bottom: 10px;
}
compositeblock.image-container > image-viewer {
  display: block;
}
compositeblock.image-container.inline {
  width: auto;
  margin-top: 0;
  margin-bottom: 0;
  display: inline-block;
}
.image-caption > line.text-mode:first-child {
  display: inline;
}
.image-caption > line.text-mode:first-child > blocks {
  display: inline;
}
.add-caption {
  opacity: 0.85;
  text-align: "center";
  color: #1155cc;
  cursor: pointer;
  position: absolute;
  bottom: -35px;
  left: 50%;
  transform: translate(-50%, 0);
  z-index: 10;
  font-size: 13px;
  background: white;
  border: 1px solid lightgray;
  padding: 5px;
}
.add-caption:hover {
  opacity: 1;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .power-index-symbol-container {
  margin-right: 0.06em;
  margin-left: 0.03em;
}
math-type .power-index-symbol-container.has-power > .power-value {
  margin-left: 0.04em;
}
math-type .power-index-symbol-container > .power-value,
math-type .pre-script-symbol-container > .power-value {
  /*margin-bottom: -2px;*/
  float: left;
  clear: both;
  text-align: left;
}
math-type .power-index-symbol-container > .power-value.small > line,
math-type .pre-script-symbol-container > .power-value.small > line {
  margin-bottom: -0.35em;
}
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .power-value > area-container > line,
math-type .pre-script-symbol-container > .power-value > area-container > line,
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > middle-base,
math-type .pre-script-symbol-container > middle-base {
  display: block;
  clear: both;
  height: 1em;
}
math-type .power-index-symbol-container > middle-base > inline,
math-type .pre-script-symbol-container > middle-base > inline {
  display: inline-block;
}
math-type .power-index-symbol-container > .index-value,
math-type .pre-script-symbol-container > .index-value {
  float: left;
  text-align: left;
}
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .index-value > area-container > line,
math-type .pre-script-symbol-container > .index-value > area-container > line,
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > editarea-block.index-value,
math-type .pre-script-symbol-container > editarea-block.index-value,
math-type .power-index-symbol-container > editarea-line.index-value,
math-type .pre-script-symbol-container > editarea-line.index-value {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > editarea-block.power-value,
math-type .pre-script-symbol-container > editarea-block.power-value,
math-type .power-index-symbol-container > editarea-line.power-value,
math-type .pre-script-symbol-container > editarea-line.power-value {
  font-size: 0.7em;
}
math-type .pre-script-symbol-container > .power-value {
  float: right;
}
math-type .pre-script-symbol-container > .index-value {
  float: right;
}
.icon-power-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-index-symbol .square-up {
  margin-top: 4px;
}
.icon-power-index-symbol .square-down {
  margin-top: 14px;
  margin-left: -6px;
}
.icon-power-index-symbol .align-end {
  margin-top: 4px;
}
.icon-power-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-symbol .square {
  margin-top: 4px;
}
.icon-power-symbol .align-end {
  margin-top: 4px;
}
.icon-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-index-symbol .square {
  margin-top: 14px;
  margin-left: 0px;
}
.icon-index-symbol .align-end {
  margin-top: 4px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.matrix-like > matrix > table > tbody > tr > td {
  padding-bottom: 0.1em;
  padding-top: 0.1em;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr.hline {
  border-top: 1px solid;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.last-hline {
  border-bottom: 1px solid;
}
.matrix-symbol {
  /* must be flex to have vertical center align , unless figure out another way */
  display: inline-flex;
  align-items: center;
}
.matrix-symbol > matrix > table > tbody > tr > td > .sbd {
  position: absolute;
  left: -1px;
  top: -1px;
  right: -1px;
  bottom: -1px;
  pointer-events: none;
  background: none;
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd {
  border-top: 1px solid rgba(93, 92, 92, 0.15);
  border-left: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lr {
  border-bottom: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lc {
  border-right: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol > base-line-indicator {
  height: inherit;
  margin-top: -0.18em;
}
.matrix-symbol matrixclosesymbol,
.matrix-symbol matrixopensymbol {
  font-style: normal;
  color: black;
  position: relative;
}
.matrix-symbol matrixclosesymbol > span,
.matrix-symbol matrixopensymbol > span {
  visibility: hidden;
  display: inline-block;
}
.matrix-symbol matrixclosesymbol > svg,
.matrix-symbol matrixopensymbol > svg {
  overflow: visible;
  font-size: 15px;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
.matrix-symbol matrixclosesymbol > svg text,
.matrix-symbol matrixopensymbol > svg text {
  fill: black;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td {
  padding: 0 0.3em;
}
.matrix-symbol > matrix {
  display: flex;
  position: relative;
  float: left;
  align-items: flex-start;
  break-inside: avoid;
}
.matrix-symbol > matrix > svg {
  width: 0.6em;
  /*init height, willl be changed by inline style*/
  height: 3px;
  overflow: visible;
  align-self: flex-start;
}
.matrix-symbol > matrix > vcomposed-symbol {
  height: inherit;
  align-self: stretch;
}
.matrix-symbol > matrix > table {
  border: 1px solid transparent;
  border-collapse: collapse;
}
.matrix-symbol > matrix > table > tbody > tr {
  box-sizing: border-box;
}
.matrix-symbol > matrix > table > tbody > tr.smaller {
  font-size: 0.75em;
}
.matrix-symbol > matrix > table > tbody > tr > td {
  position: relative;
  border: 1px dotted transparent;
  box-sizing: border-box;
  padding: 0 0.3em;
  vertical-align: baseline;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  display: inline-block;
  width: 100%;
}
.matrix-symbol > matrix > table > tbody > tr > td.vline {
  border-left: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td:last-child.last-vline {
  border-right: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table {
  margin-left: -0.2em;
  margin-right: -0.2em;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left {
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right {
  text-align: right;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.gathered > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.gathered line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td {
  padding: 0;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell {
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell {
  text-align: left;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix > border-design {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: block;
  background-color: rgba(255, 255, 255, 0.7);
  z-index: 10;
}
.matrix-symbol > matrix > border-design > border-line {
  cursor: pointer;
  position: absolute;
  /*border:1px solid gray;*/
}
.matrix-symbol > matrix > border-design > border-line > horizontal-line {
  border-top: 1px solid #eceaea;
  display: block;
  position: absolute;
  top: 50%;
  width: 100%;
  height: 1px;
  margin-top: 0;
  left: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line {
  border-left: 1px solid #eceaea;
  display: block;
  position: absolute;
  left: 50%;
  width: 1px;
  height: 100%;
  top: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line.enabled {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line:hover > horizontal-line {
  border-top: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line:hover > vertical-line {
  border-left: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line.enabled > horizontal-line {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line.enabled > vertical-line {
  border-left: 1px solid;
}
.matrix-symbol > matrix > setting {
  padding: 7px;
  position: absolute;
  top: -6px;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
  transform: translate(0, -100%);
  left: 0;
}
.matrix-symbol > matrix > setting > main-setting {
  display: flex;
  flex-direction: row;
}
.matrix-symbol > matrix > setting > main-setting styled-select {
  display: block;
  background-color: white;
}
.fa-table.array-settings {
  border: 1px solid lightgray;
  padding: 3px 5px;
  font-size: 14px;
  color: gray;
  cursor: pointer;
  /*margin-left: 5px;*/
}
.fa-table.array-settings:hover {
  color: black;
  background: white;
}
.matrix-icon {
  display: flex;
}
.matrix-icon .square {
  margin-top: 2px;
}
.matrix-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td.non-select,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 0.2em;
  padding: 0;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

.array-icon .square {
  margin-top: 2px;
}
.array-icon .display-flex {
  display: flex;
}

.matrix-like.binom > .binom > table > tbody > tr > td {
  padding: 0;
}
.matrix-like.binom > .binom > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.align-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.align-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.align-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.align-symbol > matrix > bulb {
  left: 50%;
}
.matrix-symbol.align-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.align-symbol > matrix.align {
  width: 100%;
  display: block;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: flex-start;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
  text-align: left;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container {
  align-items: flex-end;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container > line {
  width: auto;
  text-align: right;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.non-select {
  border: none;
  user-select: none;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.gather-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.gather-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.gather-symbol > matrix.gather {
  width: 100%;
  display: block;
}
.matrix-symbol.gather-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.gather-symbol > matrix > bulb {
  left: -1em;
}
.matrix-symbol.gather-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 1.5em;
  border: none;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: center;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

math-type compositeblock.table-symbol {
  width: 100%;
  display: flex;
}
math-type compositeblock.table-symbol.cap-above {
  flex-direction: column;
}
math-type .matrix-symbol > matrix.table {
  width: 100%;
  flex-direction: column;
  align-items: stretch;
}
math-type .matrix-symbol > matrix.table > table {
  table-layout: fixed;
  border: unset;
  width: 100%;
}
math-type .matrix-symbol > matrix.table > table > tbody > tr > td {
  vertical-align: top;
  padding: 0;
  position: relative;
}
math-type .cell-border-box {
  position: absolute;
  left: -1px;
  top: -1px;
  width: 100%;
  height: 100%;
}
.table-caption > line.text-mode:first-child {
  display: inline;
}
.table-caption > line.text-mode:first-child > blocks {
  display: inline;
}

editarea.lttb.text-mode > line.text-mode > blocks {
  text-align: inherit;
}



math-type compositeblock.table-of-content {
  display: block;
  width: 100%;
}
math-type compositeblock.table-of-content > toc-wrapper {
  position: relative;
  width: 100%;
  display: block;
  cursor: default;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons {
  display: none;
  position: absolute;
  left: -65px;
  width: 70px;
  top: -20px;
  bottom: 0;
  font-size: 1em;
  z-index: 999;
  padding-top: 20px;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-refresh,
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-settings {
  border: 1px solid #c3c2c2;
  padding: 0.3em;
  padding-top: 0.1em;
  line-height: 1.2;
  padding-bottom: 0;
  cursor: pointer;
  background-color: #f7f7f7;
  color: gray;
  width: 12px;
  display: inline-block;
  margin-left: 5px;
}
math-type compositeblock.table-of-content > toc-wrapper:hover .toc-setting-icons {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode {
  width: 100%;
  cursor: default;
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode {
  display: block;
  width: auto;
  cursor: default;
  padding-left: 1em;
  padding-right: 15px;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > prefix,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > prefix {
  display: none;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl {
  padding-left: 15px;
  padding-right: 1em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks {
  text-align: right;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks > compositeblock.toc-page-number-symbol {
  float: left;
  padding-left: 0;
  margin-right: 0;
  margin-left: 0;
  padding-right: 0.5em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode a > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
  cursor: pointer;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > compositeblock.toc-page-number-symbol {
  float: right;
  padding-left: 0.5em;
  margin-right: 0;
}

.icon-integral-symbol {
  margin: auto 4px auto auto;
  display: flex;
  flex-direction: row-reverse;
  font-size: 12px;
}
.icon-integral-symbol .square-up {
  border-width: 1px;
  margin-top: 0px;
}
.icon-integral-symbol .square-down {
  border-width: 1px;
  margin-top: 21px;
  margin-left: -10px;
}
.icon-integral-symbol .align-end {
  margin-top: 6px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type {
  position: relative;
}
math-type .limit-type > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.4em;
  left: 0.6em;
  align-items: flex-start;
}
math-type .limit-type > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .limit-type > .to,
math-type .limit-type > .from {
  float: left;
  clear: both;
}
math-type .limit-type > .to > line,
math-type .limit-type > .from > line,
math-type .limit-type > .to > editarea > line,
math-type .limit-type > .from > editarea > line {
  font-size: 0.7em;
}
math-type .limit-type > editarea-line,
math-type .limit-type > editarea-block {
  font-size: 0.7em;
}
math-type .limit-type > symbol {
  display: block;
  clear: both;
  pointer-events: none;
}
math-type .limit-type > symbol > span {
  white-space: nowrap;
  pointer-events: none;
}
math-type .limit-type > setting {
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  opacity: 0.5;
  opacity: 1;
  position: absolute;
  left: 50%;
  top: -2em;
  font-size: 0.6em;
  margin-left: -0.6em;
  padding: 0 0.2em;
  cursor: pointer;
}
math-type .limit-type > setting:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > setting:hover {
  border: 1px solid gray;
}
math-type .limit-type > setting > i {
  transform: rotate(-60deg);
}
math-type .limit-type.limit-kind > setting > i {
  transform: rotate(45deg);
}
math-type .limit-type.limit-kind > symbol {
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from,
math-type .limit-type.limit-kind > .to {
  width: 100%;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from > line,
math-type .limit-type.limit-kind > .to > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.from {
  height: 0;
  margin-top: -0.75em;
}
math-type .limit-type.limit-kind > empty.from > editarea.selected > line,
math-type .limit-type.limit-kind > empty.from > editarea-block.selected,
math-type .limit-type.limit-kind > empty.from > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to {
  height: 0;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to > editarea.selected > line,
math-type .limit-type.limit-kind > empty.to > editarea-block.selected,
math-type .limit-type.limit-kind > empty.to > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .integral-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .integral-like-symbol.int-ml {
  margin-left: -0.5em;
}
math-type .integral-like-symbol.oint-ml {
  margin-left: -0.3em;
}
math-type .integral-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .integral-like-symbol > symbol > span {
  line-height: 1.4em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.lim-like-symbol {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .limit-type.lim-like-symbol.close-left {
  margin-left: 0;
}
math-type .limit-type.lim-like-symbol.close-right {
  margin-right: 0;
}
math-type .limit-type.lim-like-symbol.limit-kind > empty.from > editarea {
  margin-top: -0.4em;
}
math-type .lim-like-symbol > add {
  left: 50%;
  top: -1em;
}
math-type .lim-like-symbol > symbol.inf {
  text-decoration: underline;
}
math-type .lim-like-symbol > symbol.sup {
  text-decoration: overline;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from,
math-type .lim-like-symbol.non-limit-kind > editarea.to {
  margin-left: 1.47em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-lim {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-liminf {
  margin-left: 3.15em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-limsup {
  margin-left: 3.528em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-sup {
  margin-left: 1.6905em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-varlimsup {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to {
  margin-left: 2.072em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-lim {
  margin-left: 2.1756em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-liminf {
  margin-left: 4.44em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-limsup {
  margin-left: 4.9728em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-sup {
  margin-left: 2.3828em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-varlimsup {
  margin-left: 2.1756em;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.summation-like-symbol.limit-kind > empty.from {
  margin-top: -0.3em;
}
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea,
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea-block {
  margin-top: -0.2em;
}
math-type .summation-like-symbol.inline > add {
  top: -1.1em;
}
math-type .summation-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .summation-like-symbol.inline > symbol > span {
  vertical-align: 0.15em;
}
math-type .summation-like-symbol {
  padding-right: 0.15em;
}
math-type .summation-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .summation-like-symbol > symbol > span {
  vertical-align: 0.1em;
  line-height: 1.4em;
}
math-type .summation-like-symbol > add {
  top: -1.5em;
}
math-type .summation-like-symbol > .custom-symbol {
  font-weight: bold;
}

hcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
hcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
}
hcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  white-space: nowrap;
  position: relative;
  overflow: hidden;
}
hcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
hcomposed-symbol > middle > fixed > inside {
  display: inline-block;
  overflow: hidden;
}
hcomposed-symbol > end {
  display: block;
  overflow: hidden;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .arrow-like-symbol {
  padding: 0 0.2em;
}
math-type .arrow-like-symbol > arrow-like-simple > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  left: 0.8em;
  top: -0.7em;
}
math-type .arrow-like-symbol > arrow-like-simple > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .arrow-like-symbol > arrow-like-simple > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .arrow-like-symbol > middle {
  display: block;
  text-align: center;
  text-align-last: auto;
  clear: both;
  width: 100%;
  position: relative;
}
math-type .arrow-like-symbol > middle > inside {
  display: inline-block;
  height: 0.55em;
  width: 100%;
}
math-type .arrow-like-symbol > middle > inside > hcomposed-symbol {
  position: absolute;
  top: 0.4em;
  left: 0;
}
math-type .arrow-like-symbol > editarea.sright-1 {
  padding-left: 0.55em;
  padding-right: 0.25em;
}
math-type .arrow-like-symbol > editarea.sleft-1 {
  padding-left: 0.25em;
  padding-right: 0.55em;
}
math-type .arrow-like-symbol > editarea.small-margin {
  padding-left: 0.4em;
  padding-right: 0.4em;
}
math-type .arrow-like-symbol > editarea.large-padding {
  margin: 0 1.3em;
}
math-type .arrow-like-symbol > editarea > line {
  font-size: 0.7em;
}
math-type .arrow-like-symbol > .top {
  float: left;
  width: 100%;
  clear: both;
  margin-bottom: -0.5em;
  z-index: 1;
  position: relative;
}
math-type .arrow-like-symbol > .top.space-1,
math-type .arrow-like-symbol > .top.up-space-1-lower-space-2 {
  margin-bottom: -0.4em;
}
math-type .arrow-like-symbol > .bottom {
  margin-top: -0.45em;
  float: left;
  width: 100%;
}
math-type .arrow-like-symbol > .bottom.space-1,
math-type .arrow-like-symbol > .bottom.lower-space-1 {
  margin-top: -0.35em;
}
math-type .arrow-like-symbol > .bottom.space-2,
math-type .arrow-like-symbol > .bottom.up-space-1-lower-space-2 {
  margin-top: -0.25em;
}

.over-icon {
  margin: auto;
  width: 12px;
  font-size: 13px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-arrow-symbol > arrow-symbol {
  display: block;
  margin-right: -0.05em;
  position: relative;
}
math-type .over-arrow-symbol > arrow-symbol > hcomposed-symbol {
  position: absolute;
}
math-type .over-arrow-symbol > arrow-symbol > arrow-wrapper {
  margin-right: -0.2em;
}
math-type .over-arrow-symbol > editarea {
  display: inline-flex;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea > area-container > line,
math-type .over-arrow-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea-block {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
  display: inline-block;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-line-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
math-type .over-line-symbol > editarea {
  display: inline-flex;
  min-width: 0.5em;
}
math-type .over-line-symbol > editarea-line {
  min-width: 0.5em;
  display: inline-block;
  text-align: center;
  text-align-last: auto;
}
math-type .over-line-symbol > line-border {
  display: block;
  position: relative;
}
math-type .over-line-symbol > line-border > hcomposed-symbol {
  position: absolute;
}
math-type .over-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

brace-top-wrapper {
  display: flex;
  flex-direction: row;
  height: 100%;
  font-family: Asana-Math, Asana;
}
brace-top-wrapper > middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
brace-top-wrapper > middle-wrapper > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
brace-top-wrapper > middle-wrapper > fixed > middle-inside {
  overflow: hidden;
}
brace-top-wrapper first,
brace-top-wrapper middle,
brace-top-wrapper last {
  overflow: hidden;
  position: relative;
}
brace-top-wrapper first {
  min-width: 0.7em;
  width: 0.7em;
}
brace-top-wrapper > middle {
  min-width: 0.6em;
  width: 0.6em;
}
brace-top-wrapper > last {
  min-width: 0.7em;
  width: 0.7em;
}
bracket-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
bracket-top-wrapper > first,
bracket-top-wrapper middle,
bracket-top-wrapper last {
  overflow: hidden;
  position: relative;
}
bracket-top-wrapper > first {
  height: 0.5em;
  min-height: 0.5em;
}
bracket-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
bracket-top-wrapper middle-wrapper > fixed {
  overflow: hidden;
  position: absolute;
  left: 0;
  top: 0;
}
bracket-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
bracket-top-wrapper > last {
  height: 0.65em;
  min-height: 0.65em;
}
parenthesis-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
parenthesis-top-wrapper > first,
parenthesis-top-wrapper middle,
parenthesis-top-wrapper last {
  overflow: hidden;
  position: relative;
  height: 1em;
  min-height: 1em;
}
parenthesis-top-wrapper > first {
  min-height: 0.9em;
  height: 0.9em;
}
parenthesis-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
parenthesis-top-wrapper middle-wrapper > fixed {
  position: absolute;
  top: 0;
  left: 0;
}
parenthesis-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
parenthesis-top-wrapper > last {
  min-height: 1em;
  height: 1em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-brace-symbol {
  position: relative;
}
math-type .over-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.5em;
  margin-left: -0.6em;
}
math-type .over-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .over-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .over-brace-symbol > top-brace {
  pointer-events: none;
  display: block;
  min-width: 1.1em;
  position: relative;
  clear: both;
  margin-bottom: -0.1em;
  font-style: normal;
  font-weight: normal;
}
math-type .over-brace-symbol > top-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type .over-brace-symbol > editarea {
  display: inline-flex;
  width: 100%;
  align-self: center;
  clear: both;
}
math-type .over-brace-symbol > editarea.overValue {
  font-size: 0.7em;
  float: left;
  width: 100%;
  margin-bottom: 0.1em;
}

.icon-hat {
  margin: auto;
  width: 12px;
  font-size: 12px;
}
.icon-hat .square {
  margin-top: -3px;
}

.under-arc-symbol {
  display: inline-block;
}
.under-arc-symbol > editarea {
  display: inline-flex;
}
.under-arc-symbol > symbol {
  display: block;
  width: 100%;
  position: relative;
}
.under-arc-symbol > symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  display: block;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .under-line-symbol > editarea {
  display: inline-flex;
}
math-type .under-line-symbol > line-border {
  display: block;
  position: relative;
  float: left;
  width: 100%;
}
math-type .under-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.under-brace-symbol {
  display: inline-flex;
  flex-flow: column;
  position: relative;
}
math-type compositeblock.under-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: 3em;
}
math-type compositeblock.under-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type compositeblock.under-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type compositeblock.under-brace-symbol > bottom-brace {
  pointer-events: none;
  display: block;
  position: relative;
  min-width: 1.3em;
  font-style: normal;
  font-weight: normal;
}
math-type compositeblock.under-brace-symbol > bottom-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type compositeblock.under-brace-symbol > editarea {
  margin-left: 0.15em;
  margin-right: 0.15em;
  align-self: center;
}
math-type compositeblock.under-brace-symbol > editarea.underValue {
  font-size: 0.7em;
}
.under-brace-icon {
  width: 12px;
  margin: auto;
  font-size: 12px;
}
.under-brace-icon .brace-wrapper {
  margin-top: -14px;
}


math-type .operator-name > editarea {
  margin-left: 0.2em;
  margin-right: 0.2em;
  display: inline-flex;
}
math-type .operator-name > editarea.close-left {
  margin-left: 0;
}
math-type .operator-name > editarea.close-right {
  margin-right: 0;
}

.math-group > editarea {
  float: left;
}
.group-icon .rectangle {
  width: 23px;
  height: 12px;
  border-style: solid;
  border-width: 1px;
  text-align: center;
  border-color: gray;
  font-family: fantasy;
  color: black;
  padding-top: 1px;
  font-size: 9px;
  line-height: 14px;
  vertical-align: middle;
  margin: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.over-symbol {
  position: relative;
}
math-type compositeblock.over-symbol > symbol {
  font-family: Asana-Math, Asana, Arial;
  height: 8em;
  display: block;
  text-align: center;
  text-align-last: auto;
  position: relative;
}
math-type compositeblock.over-symbol > symbol > inner {
  display: block;
  position: absolute;
  text-align: center;
  text-align-last: auto;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.over-symbol > symbol.dot > inner.left-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner.right-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.right-sign {
  transform: translate(0.2em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner,
math-type compositeblock.over-symbol > symbol.ring > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.left-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.right-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.right-sign {
  transform: translate(0.15em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.ignore-shift,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.ignore-shift {
  transform: translate(0, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner,
math-type compositeblock.over-symbol > symbol.small-tilde > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.right-sign {
  transform: translate(0.25em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner {
  transform: translate(0.1em, 0);
}
math-type compositeblock.over-symbol > symbol.grave,
math-type compositeblock.over-symbol > symbol.breve,
math-type compositeblock.over-symbol > symbol.acute {
  font-family: 'Times New Roman', Times, serif;
}
math-type compositeblock.over-symbol > symbol.grave > inner.left-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.left-sign,
math-type compositeblock.over-symbol > symbol.check > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.grave > inner.right-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.right-sign,
math-type compositeblock.over-symbol > symbol.check > inner.right-sign {
  transform: translate(0.17em, 0);
}
math-type compositeblock.over-symbol > symbol.ddddot {
  min-width: 0.9em;
}
math-type compositeblock.over-symbol > symbol.dddot {
  min-width: 0.7em;
}

.math-xx > editarea {
  float: left;
}

math-type .big-delimiter-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  margin: 0.1em 0;
}
math-type .big-delimiter-symbol big-delimiter.big-open {
  margin-left: 0.09em;
}
math-type .big-delimiter-symbol big-delimiter.big-close {
  margin-right: 0.07em;
}
math-type .big-delimiter-symbol > base-line-indicator {
  height: inherit;
}
math-type .big-delimiter-symbol > big-delimiter > svg {
  height: 100%;
  width: 100%;
}
math-type .big-delimiter-symbol > big-delimiter > bulb {
  left: -10px;
}
math-type .big-delimiter-symbol > big-delimiter > setting {
  width: 158px;
  display: flex;
  position: absolute;
  left: 0;
  top: -40px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container {
  margin-right: 4px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container:last-child {
  margin-right: 0px;
}

select-buttons {
  font-size: 13px;
  color: gray;
  display: block;
}
select-buttons > sb-item {
  display: inline-block;
  padding: 2px 2px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
select-buttons > sb-item.selected {
  background-color: white;
  border: 1px solid lightgray;
}
select-buttons > sb-item:hover {
  border: 1px solid lightgray;
}
select-buttons > sb-item.disabled {
  opacity: 0.3;
  cursor: default;
  border: 1px solid transparent;
}
select-buttons > sb-item.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}

tabs-container tab-item {
  color: gray;
}
tabs-container tab-item:hover {
  color: black;
}

expandable-component.button-action {
  cursor: pointer;
  color: gray;
  fill: gray;
}
expandable-component.button-action:hover,
expandable-component.button-action.selected {
  color: black;
  fill: black;
}
expandable-component.button-action:hover label-display,
expandable-component.button-action.selected label-display {
  border: 1px solid #e2e0e0;
}
expandable-component.button-action label-display {
  font-size: 12px;
  padding-top: 5px;
  display: flex;
  border: 1px solid transparent;
  padding-left: 2px;
  padding-right: 2px;
  margin-top: 0px;
  padding-bottom: 4px;
  cursor: pointer;
}
expandable-component.button-action label-display > i {
  padding-left: 5px;
  padding-top: 1px;
}
expandable-component.button-action label-item-container > label-item:hover {
  background-color: #bfe4bd;
}
expandable-component.button-action label-item-container > label-item.ignore-select {
  background-color: inherit;
  cursor: default;
}
expandable-component.button-action.button-style label-display {
  background: white;
  border: 1px solid lightgray;
}
expandable-component.button-action.button-style:hover,
expandable-component.button-action.button-style.selected {
  color: gray;
}
expandable-component.button-action.button-style:hover label-display,
expandable-component.button-action.button-style.selected label-display {
  background: #f7f6f6;
}

g.group-box-move {
  opacity: 0.2;
}
g.group-box-move:hover {
  opacity: 0.8;
}




.math-diagram .intersections-group {
  stroke-width: 2px;
  stroke: black;
  fill: transparent;
  cursor: move;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.math-diagram > math-diagram {
  background: white;
}
math-type compositeblock.math-diagram {
  cursor: default;
  width: 100%;
  /** display block as if inline block, it will be disapear in some cases*/
  display: block;
}
math-type compositeblock.math-diagram .connection-point {
  cursor: crosshair;
}
math-type compositeblock.math-diagram .connection-point g {
  fill-opacity: 0.6;
}
math-type compositeblock.math-diagram .connection-point:hover g {
  fill-opacity: 1;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode {
  font-size: unset;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > block {
  white-space: pre;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > blocks > block {
  white-space: pre;
}
math-type compositeblock.math-diagram > math-diagram {
  border: 1px solid transparent;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region {
  display: block;
  width: 100%;
  height: 100%;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region > svg {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.math-diagram .add-label {
  fill: gray;
}
math-type compositeblock.math-diagram .add-label:hover {
  fill: black;
}
math-type compositeblock.math-diagram .diagram-editor {
  margin: 0 2px;
}
math-type compositeblock.math-diagram .control-point-guide {
  stroke: lightgray;
  stroke-width: 0.5px;
  pointer-events: none;
}
math-type compositeblock.math-diagram .connection-group {
  stroke: black;
  fill: none;
}
math-type compositeblock.math-diagram .arrow-line {
  cursor: move;
}
math-type compositeblock.math-diagram .mobile-tablet .shape .transparent,
math-type compositeblock.math-diagram .mobile-tablet .composite-shape .transparent {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .shape,
math-type compositeblock.math-diagram .composite-shape {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .shape .transparent,
math-type compositeblock.math-diagram .composite-shape .transparent {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > line,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > path {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .connection {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .connection.transparent,
math-type compositeblock.math-diagram .connection.transparent > line,
math-type compositeblock.math-diagram .connection.transparent > path {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .frame {
  stroke-width: 1px;
  fill: transparent;
}
math-type math-diagram {
  display: block;
  position: relative;
  width: 100%;
  height: 300px;
}
math-type math-diagram position-container {
  position: absolute;
  width: 1px;
  height: 1px;
  display: block;
}
math-type math-diagram dg-editor-container {
  position: absolute;
  min-width: 0.85em;
  border-collapse: border-box;
}
math-type math-diagram coverlayer {
  position: absolute;
  background: transparent;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  cursor: move;
}
math-type math-diagram connection-point {
  position: absolute;
  display: block;
  height: 6px;
  width: 6px;
  background: lightgray;
  border: 1px solid gray;
  bottom: -10px;
  left: 50%;
  margin-left: -3px;
  cursor: e-resize;
}
math-type .diagram-caption > line.text-mode:first-child {
  display: inline;
}
math-type .diagram-caption > line.text-mode:first-child > blocks {
  display: inline;
}


.plot-input-style-settings {
  opacity: 0.5;
}
.plot-input-style-settings:hover {
  opacity: 1;
}

.psa-cn .ps-hint {
  opacity: 0;
  transition: opacity 0.3s linear;
}
.psa-cn:hover .ps-hint {
  opacity: 0.6;
}

.role-toolbar-wrapper.dg-full-view tool-bar too-bar-container {
  justify-content: start;
  width: auto;
  min-width: 0;
}
.role-toolbar-wrapper.dg-full-view diagram-settings {
  width: auto;
}

.dg-items-bar-container item {
  display: inline-block;
  padding: 3px;
  fill: gray;
  stroke: gray;
}
.dg-items-bar-container item,
.dg-items-bar-container item-option {
  border: 1px transparent solid;
}
.dg-items-bar-container item:hover,
.dg-items-bar-container item-option:hover {
  border: 1px #c4c1c1 solid;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.theorem {
  display: block;
}
math-type compositeblock.theorem.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type theorem-name {
  min-width: 20px;
  display: inline;
}
math-type theorem-name > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content {
  min-width: 100px;
  display: inline;
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child > blocks {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > blocks > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > blocks > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content .qed-symbol {
  line-height: 1em;
}
.deletable {
  cursor: pointer;
}
.deletable:hover {
  color: red;
}

.regular-checkbox:hover {
  background-color: #f3f2f2;
}

@media print {
  code[class*="language-"],
  pre[class*="language-"] {
    text-shadow: none !important;
  }
}
math-type .code-section prefix.code-line-number {
  color: #a9a7a7;
  width: 2.5em;
  display: inline-block;
  flex-shrink: 0;
}
math-type .code-section prefix.code-line-number.prefix-l10 {
  width: 1.5em;
}
math-type .code-section prefix.code-line-number.prefix-l100 {
  width: 2em;
}
math-type .code-section .code-line-blocks-container {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section .code-line-blocks-container block.token {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section line.text-mode.code-section-line {
  display: flex;
  flex-direction: row;
  line-height: 1.5;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-default editarea {
  color: black;
}
.code-section.theme-default .token.comment,
.code-section.theme-default .token.prolog,
.code-section.theme-default .token.doctype,
.code-section.theme-default .token.cdata {
  color: slategray;
}
.code-section.theme-default .token.punctuation {
  color: #999;
}
.code-section.theme-default .namespace {
  opacity: 0.7;
}
.code-section.theme-default .token.property,
.code-section.theme-default .token.tag,
.code-section.theme-default .token.boolean,
.code-section.theme-default .token.number,
.code-section.theme-default .token.constant,
.code-section.theme-default .token.symbol,
.code-section.theme-default .token.deleted {
  color: #905;
}
.code-section.theme-default .token.selector,
.code-section.theme-default .token.attr-name,
.code-section.theme-default .token.string,
.code-section.theme-default .token.char,
.code-section.theme-default .token.builtin,
.code-section.theme-default .token.inserted {
  color: #690;
}
.code-section.theme-default .token.operator,
.code-section.theme-default .token.entity,
.code-section.theme-default .token.url,
.code-section.theme-default .language-css .token.string,
.code-section.theme-default .style .token.string {
  color: #9a6e3a;
}
.code-section.theme-default .token.atrule,
.code-section.theme-default .token.attr-value,
.code-section.theme-default .token.keyword {
  color: #07a;
}
.code-section.theme-default .token.function,
.code-section.theme-default .token.class-name {
  color: #DD4A68;
}
.code-section.theme-default .token.regex,
.code-section.theme-default .token.important,
.code-section.theme-default .token.important1,
.code-section.theme-default .token.variable {
  color: #e90;
}
.code-section.theme-default .token.important,
.code-section.theme-default .token.bold,
.code-section.theme-default .token.bold1 {
  font-weight: bold;
}
.code-section.theme-default .token.italic,
.code-section.theme-default .token.italic1 {
  font-style: italic;
}
.code-section.theme-default .token.entity {
  cursor: help;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-tomorrow-night {
  /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */
}
.code-section.theme-tomorrow-night editarea {
  caret-color: #ccc;
}
.code-section.theme-tomorrow-night editarea {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.comment,
.code-section.theme-tomorrow-night .token.block-comment,
.code-section.theme-tomorrow-night .token.prolog,
.code-section.theme-tomorrow-night .token.doctype,
.code-section.theme-tomorrow-night .token.cdata {
  color: #999;
}
.code-section.theme-tomorrow-night .token.punctuation {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.tag,
.code-section.theme-tomorrow-night .token.attr-name,
.code-section.theme-tomorrow-night .token.namespace,
.code-section.theme-tomorrow-night .token.deleted {
  color: #e2777a;
}
.code-section.theme-tomorrow-night .token.function-name {
  color: #6196cc;
}
.code-section.theme-tomorrow-night .token.boolean,
.code-section.theme-tomorrow-night .token.number,
.code-section.theme-tomorrow-night .token.function {
  color: #f08d49;
}
.code-section.theme-tomorrow-night .token.property,
.code-section.theme-tomorrow-night .token.class-name,
.code-section.theme-tomorrow-night .token.constant,
.code-section.theme-tomorrow-night .token.symbol {
  color: #f8c555;
}
.code-section.theme-tomorrow-night .token.selector,
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.important1,
.code-section.theme-tomorrow-night .token.atrule,
.code-section.theme-tomorrow-night .token.keyword,
.code-section.theme-tomorrow-night .token.builtin {
  color: #cc99cd;
}
.code-section.theme-tomorrow-night .token.string,
.code-section.theme-tomorrow-night .token.char,
.code-section.theme-tomorrow-night .token.attr-value,
.code-section.theme-tomorrow-night .token.regex,
.code-section.theme-tomorrow-night .token.variable {
  color: #7ec699;
}
.code-section.theme-tomorrow-night .token.operator,
.code-section.theme-tomorrow-night .token.entity,
.code-section.theme-tomorrow-night .token.url {
  color: #67cdcc;
}
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.bold,
.code-section.theme-tomorrow-night .token.bold1 {
  font-weight: bold;
}
.code-section.theme-tomorrow-night .token.italic,
.code-section.theme-tomorrow-night .token.italic1 {
  font-style: italic;
}
.code-section.theme-tomorrow-night .token.entity {
  cursor: help;
}
.code-section.theme-tomorrow-night .token.inserted {
  color: green;
}

editor-container > math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
math-type.dark-mode editarea.root-editor {
  color: #e0e0e0;
  fill: #e0e0e0;
  stroke: #e0e0e0;
  border-color: #e0e0e0;
}
math-type.dark-mode editarea.root-editor {
  background: #1e1e1e;
}
math-type.dark-mode .math-container-symbol.selected,
math-type.dark-mode .math-container-symbol.display.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.align-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr.selected:not(.hline) {
  border-top: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.selected {
  border-bottom: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td.selected:not(.vline) {
  border-left: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td:last-child.selected {
  border-right: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode selection-wrapper > selection {
  background-color: rgba(33, 150, 243, 0.25);
}
math-type.dark-mode selection-wrapper.inactive > selection {
  background-color: rgba(255, 255, 255, 0.27);
}
math-type.dark-mode editarea.selected {
  outline: 1px solid rgba(177, 174, 174, 0.3);
}
math-type.dark-mode compositeblock.math-diagram > math-diagram {
  background: #1e1e1e;
}
container-layer.dark-mode editor-container {
  background: #1e1e1e;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
editor-container > math-type {
  background: white;
  outline: 1px solid lightgray;
}
math-type {
  display: block;
  position: relative;
  padding: 20px;
  color: black;
  padding-top: 15px;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  outline: none;
  cursor: text;
  text-align: initial;
}
math-type .rcnt {
  color: white;
  font-size: 12px;
  position: -webkit-sticky;
  position: sticky;
  top: 0;
  bottom: 0;
  display: flex;
  flex-direction: row;
}
math-type > .mt-sa {
  position: absolute;
  top: 0;
  left: -100px;
  right: -100px;
  bottom: -400px;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  pointer-events: none;
}
math-type.math-only compositeblock.math-container-symbol {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol.selected {
  outline: none;
  background: none;
}
math-type.math-only compositeblock.math-container-symbol > editarea {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol > editarea > line {
  justify-content: flex-start;
}
math-type > input:not([type]),
math-type input[type="text"] {
  width: 50px;
}
math-type composition-indicator {
  display: block;
  position: absolute;
  height: 2px;
  min-width: 2px;
  border-bottom: 2px solid gray;
  left: 0;
  top: 0;
}
math-type .focus-element {
  outline: none;
  overflow: hidden;
  width: 0px;
  height: 0px;
  top: 0px;
  left: 0px;
  display: block;
  position: absolute;
  font-size: 40px;
}
.scroll-without-scrollbar {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE 10+ */
}
.scroll-without-scrollbar::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;
}
#root,
.main-container {
  width: 100%;
  color: #212121;
}
.sub-text-cursor,
.text-cursor {
  position: absolute;
  color: green;
  /*font-size: 1.2em;*/
  pointer-events: none;
  border-left: 2px solid green;
  display: block;
  top: 0px;
  left: 0px;
  z-index: 10;
}
.sub-text-cursor {
  opacity: 0.4;
}
math-edit-container {
  display: block;
  outline: none;
  position: relative;
  font-family: 'Asana';
}
.root-editor {
  min-height: 500px;
  box-sizing: border-box;
}
.root-editor.restricted-view {
  min-height: unset;
}
.root-editor.test-view {
  min-height: 100px;
}
.menu {
  color: #ffffff;
  text-transform: uppercase;
  text-decoration: none;
  font-family: "HelveticaNeue-Medium", sans-serif;
  font-size: 14px;
  display: inline-block;
  transform: scale(1, 1.5);
  -webkit-transform: scale(1, 1.5);
  /* Safari and Chrome */
  -moz-transform: scale(1, 1.5);
  /* Firefox */
  -ms-transform: scale(1, 1.5);
  /* IE 9+ */
  -o-transform: scale(1, 1.5);
  /* Opera */
}
.setting-group-options {
  font-size: 13px;
  color: gray;
  fill: gray;
}
.setting-group-options > i,
.setting-group-options > svg.icon {
  padding: 3px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
.setting-group-options > i.selected,
.setting-group-options > svg.icon.selected {
  background-color: white;
  border: 1px solid lightgray;
}
.setting-group-options > i:hover,
.setting-group-options > svg.icon:hover {
  border: 1px solid lightgray;
}
.setting-group-options > i.disabled,
.setting-group-options > svg.icon.disabled {
  opacity: 0.3;
}
.setting-group-options > i.disabled:hover,
.setting-group-options > svg.icon.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}
math-type .math-text,
math-type .normal-text,
math-type .raw-latex {
  font-family: arial, verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif;
}
math-type .math-text editarea.text-mode > line.text-mode > blocks > block,
math-type .normal-text editarea.text-mode > line.text-mode > blocks > block,
math-type .raw-latex editarea.text-mode > line.text-mode > blocks > block {
  white-space: nowrap;
}
.mt-common-dialog {
  box-shadow: 1px 1px 1px 0px #e0dddd;
  background-color: #f7f7f7;
  border: 1px lightgray solid;
  z-index: 14;
  padding: 6px;
  cursor: default;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
disabled-layer {
  display: block;
  position: absolute;
  left: 0;
  top: 1px;
  right: 0;
  bottom: 2px;
  background: rgba(247, 247, 247, 0.66);
  /** consider export button z-index when change this one*/
  z-index: 500;
}
math-type tag-container tag-select-wrapper {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
math-type tag-container tag-box-select {
  position: absolute;
  display: block;
  background-color: green;
  opacity: 0;
  cursor: pointer;
  z-index: 15;
}
math-type tag-container tag-box-select:hover {
  opacity: 0.2;
}
math-type tag-container tag-box-gap {
  position: absolute;
  display: block;
  background-color: white;
  opacity: 0.9;
  z-index: 15;
}
.setting-popup-zindex {
  z-index: 11;
}
svg.selectable {
  cursor: pointer;
  border: 1px solid transparent;
}
svg.selectable.selected {
  background: white;
  border: solid 1px lightgray;
}
svg.selectable:hover {
  border: solid 1px lightgray;
}


@media print {
  @page {
    margin: 0;
  }
  /**
    Convert Preview into main print area
    */
  .math-type-doc,
  .docs-container,
  .modal-dialog-root-container,
  instructions-container {
    display: none !important;
  }
  .print-preview-container {
    position: static !important;
    display: block !important;
    visibility: visible !important;
    width: auto !important;
    height: auto !important;
    z-index: 99999 !important;
  }
  .print-container {
    position: static !important;
    overflow: hidden;
  }
  .print-preview-controls-container {
    display: none !important;
  }
  .math-type-no-print {
    display: none !important;
  }
  area-container.print-page-level {
    margin-left: 0 !important;
    margin-top: 0 !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    break-inside: avoid !important;
  }
  .area-container-border {
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    display: none !important;
  }
  #print-container {
    background-color: transparent !important;
  }
  #print-container > math-type {
    background-color: transparent !important;
  }
  #print-container > math-type > math-edit-container > editarea {
    background-color: transparent !important;
  }
  /*-----------------------------*/
  header,
  .export-bar-container {
    display: none !important;
  }
  math-type {
    padding: 0 !important;
  }
  .print-remove-background {
    background-color: transparent !important;
  }
  document-info-bar {
    display: none !important;
  }
  document-sidebar-container {
    display: none !important;
  }
  body {
    position: relative !important;
  }
  page,
  #root,
  body,
  html {
    height: 100% !important;
    width: 100% !important;
    position: relative !important;
    background: white !important;
    overflow: visible !important;
  }
}
.print-background.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
@media print {
  outline: none !important;
  .npm__react-simple-code-editor__textarea {
    display: none !important;
  }
  math-diagram {
    border: none !important;
  }
  .no-border-on-print {
    border: none !important;
  }
  .setting-select {
    display: none !important;
  }
  .no-print,
  ref-tag.empty-line-tag,
  .text-cursor,
  .sub-text-cursor,
  selection-wrapper,
  message-box-container,
  connection-controls,
  .control-point-guide,
  tool-bar,
  items-bar,
  document-sidebar,
  resize-bar,
  diagram-expander,
  warning-error-region,
  loading-layer,
  resizing-info,
  toc-refresh {
    display: none !important;
  }
  .no-print-outline {
    outline: none !important;
  }
  .selected {
    background: unset !important;
  }
  .math-container-symbol.selected {
    background: unset !important;
  }
  .matrix-symbol.align-symbol {
    background: unset !important;
  }
  .matrix-symbol.gather-symbol {
    background: unset !important;
  }
  tr.selected,
  td.selected {
    border: unset !important;
  }
  tr.selected.hline {
    border-top: 1px solid black !important;
  }
  tr.selected.last-hline {
    border-bottom: 1px solid black !important;
  }
  td.selected.vline {
    border-left: 1px solid black !important;
  }
  td.selected.last-vline {
    border-right: 1px solid black !important;
  }
  .selected {
    outline: unset !important;
  }
  container-layer {
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    height: initial !important;
    overflow: visible !important;
  }
  editor-container {
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    width: 100% !important;
  }
  content-area {
    padding: 0px !important;
    margin: 0;
    background: transparent !important;
  }
  vcomposed-symbol.non-safari > start {
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle-center {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > end {
    margin-top: -0.05em !important;
  }
}
.math-type-for-print {
  outline: none !important;
}
.math-type-for-print .npm__react-simple-code-editor__textarea {
  display: none !important;
}
.math-type-for-print math-diagram {
  border: none !important;
}
.math-type-for-print .no-border-on-print {
  border: none !important;
}
.math-type-for-print .setting-select {
  display: none !important;
}
.math-type-for-print .no-print,
.math-type-for-print ref-tag.empty-line-tag,
.math-type-for-print .text-cursor,
.math-type-for-print .sub-text-cursor,
.math-type-for-print selection-wrapper,
.math-type-for-print message-box-container,
.math-type-for-print connection-controls,
.math-type-for-print .control-point-guide,
.math-type-for-print tool-bar,
.math-type-for-print items-bar,
.math-type-for-print document-sidebar,
.math-type-for-print resize-bar,
.math-type-for-print diagram-expander,
.math-type-for-print warning-error-region,
.math-type-for-print loading-layer,
.math-type-for-print resizing-info,
.math-type-for-print toc-refresh {
  display: none !important;
}
.math-type-for-print .no-print-outline {
  outline: none !important;
}
.math-type-for-print .selected {
  background: unset !important;
}
.math-type-for-print .math-container-symbol.selected {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.align-symbol {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.gather-symbol {
  background: unset !important;
}
.math-type-for-print tr.selected,
.math-type-for-print td.selected {
  border: unset !important;
}
.math-type-for-print tr.selected.hline {
  border-top: 1px solid black !important;
}
.math-type-for-print tr.selected.last-hline {
  border-bottom: 1px solid black !important;
}
.math-type-for-print td.selected.vline {
  border-left: 1px solid black !important;
}
.math-type-for-print td.selected.last-vline {
  border-right: 1px solid black !important;
}
.math-type-for-print .selected {
  outline: unset !important;
}
.math-type-for-print container-layer {
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  height: initial !important;
  overflow: visible !important;
}
.math-type-for-print editor-container {
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  width: 100% !important;
}
.math-type-for-print content-area {
  padding: 0px !important;
  margin: 0;
  background: transparent !important;
}
.math-type-for-print vcomposed-symbol.non-safari > start {
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle-center {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > end {
  margin-top: -0.05em !important;
}
.justify-single-line {
  display: inline-block;
  text-align-last: justify;
  width: 100%;
}
.rtl-on-line-level {
  direction: rtl;
}

math-type modal-dialog.import-latex math-type editarea.root-editor {
  min-height: 100px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .mobile-keys-support-region {
  position: fixed;
  top: 84px;
  left: 45px;
  color: gray;
  z-index: 11609;
  opacity: 0.9;
  display: flex;
  width: auto;
  z-index: 600;
  cursor: pointer;
}
math-type .mobile-keys-support-region.is-android {
  top: unset;
  bottom: 4px;
  left: 17px;
}
math-type .mobile-keys-support-region.select-only {
  top: 40px;
  left: 25px;
}
math-type .mobile-keys-support-region.select-only .btn-suggestion-box-mobile {
  display: none;
}



.special-symbol-dialog__special-char {
  display: inline-block;
  width: 24px;
  height: 24px;
  line-height: 24px;
  border-bottom: 1px solid #ddd;
  border-right: 1px solid #ddd;
  text-align: center;
  cursor: pointer;
  outline: none;
}
.special-symbol-dialog__special-char:hover {
  background: #bfe4bd;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
context-menu-container {
  position: fixed;
  left: 100px;
  top: 300px;
  z-index: 13;
  box-shadow: 2px 2px 3px 0px #c3c3c3;
  border: 1px solid lightgray;
  width: 200px;
  background: white;
  cursor: default;
  outline: none;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
context-menu-container ct-item {
  display: block;
  padding: 6px 9px;
  font-size: 13px;
  color: gray;
}
context-menu-container ct-item.disabled {
  color: lightgray;
}
context-menu-container ct-item:hover {
  background: #eae9e9;
}
context-menu-container ct-item.hidden {
  display: none;
}
context-menu-container ct-icon {
  width: 20px;
  display: inline-block;
}
context-menu-container ct-separator {
  width: 100%;
  display: block;
  height: 1px;
  margin-top: 2px;
  margin-bottom: 2px;
  border-top: 1px solid lightgray;
}

/* Collection default theme */
/* Grid default theme */
/* Table default theme */









/* List default theme */



math-type .symbol-container,
.auto-complete-external-area .symbol-container {
  display: flex;
  flex-direction: row;
  min-height: 25px;
  padding-left: 4px;
  padding-right: 12px;
  align-items: center;
  cursor: pointer;
}
math-type .symbol-container.selected,
.auto-complete-external-area .symbol-container.selected {
  background-color: #bfe4bd;
}
math-type .symbol-friendly-name,
.auto-complete-external-area .symbol-friendly-name {
  flex-grow: 1;
  font-family: Asana;
  /*padding-top: 6px;*/
}
math-type .symbol-icon,
.auto-complete-external-area .symbol-icon {
  /*padding-top: 6px;*/
  margin-right: 15px;
  min-width: 20px;
  text-align: center;
}
math-type .short-cut,
.auto-complete-external-area .short-cut {
  text-align: center;
  color: gray;
  /*vertical-align: middle;*/
  /*line-height: 20px;*/
  margin: 0 2px 0 2px;
  font-size: 12px;
  display: flex;
  align-items: center;
}
math-type .short-cut span,
.auto-complete-external-area .short-cut span {
  font-size: 10px;
}
math-type .hidden,
.auto-complete-external-area .hidden {
  display: none;
}







/**different context*/
/**different context*/
selection-wrapper {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  user-select: none;
  pointer-events: none;
  z-index: 9;
}
selection-wrapper > selection {
  display: block;
  position: absolute;
  background-color: rgba(0, 126, 255, 0.15);
  user-select: none;
  width: 100px;
  height: 100px;
  transform-origin: 0 0;
}
selection-wrapper.inactive > selection {
  background-color: rgba(58, 57, 57, 0.13);
}

region-highlight-container {
  user-select: none;
  pointer-events: none;
  display: block;
  position: absolute;
  width: 0px;
  height: 0px;
  top: 0;
  left: 0;
  border: 1px solid lightgoldenrodyellow;
  opacity: 0.2;
}
region-highlight-container > rhc-all > rh-rect {
  display: block;
  position: absolute;
  background: orange;
}
region-highlight-container > rh-selected-rect {
  display: block;
  position: absolute;
  background: red;
}

.math-template-btb.btn-normal {
  background: transparent;
  margin-left: 0;
  font-size: 12px;
  border: none;
}
.math-template-btb.btn-normal:hover {
  background: white;
}
.math-template-name-item:hover {
  background: #f7f7f7;
}

.math-template-tree .tree-node-name {
  white-space: nowrap;
}
.math-template-tree .tree-node-name:hover {
  background: #f7f7f7;
}

math-type compositeblock.bib-bibliography {
  width: 100%;
  display: block;
}
math-type compositeblock.bib-cite {
  display: inline;
  white-space: break-spaces;
}
math-type compositeblock.bib-cite > editarea.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
.csl-context {
  white-space: pre-wrap;
}
.csl-context.csl-cite div {
  display: inline;
}
.csl-context div.csl-left-margin {
  float: left;
}
.csl-context div.csl-block {
  font-weight: bold;
}
.csl-context div.csl-right-inline {
  margin-left: 2.5em;
}
.csl-context div.csl-indent {
  margin-top: 0.5em;
  margin-left: 2em;
  padding-bottom: 0.2em;
  padding-left: 0.5em;
  border-left: 5px solid #ccc;
}

.caption-ref-select .role-item:hover {
  background: #edf9ec;
}

.footnote-mt-container {
  position: relative;
}
.footnote-mt-container .more-option-box {
  position: absolute;
  left: -25px;
  top: 0;
  width: 30px;
  bottom: 0;
  display: none;
}
.footnote-mt-container .more-option-box > div {
  background: #f7f7f7;
  border: 1px solid #d6d3d3;
  padding: 0 0.2em;
  cursor: pointer;
  color: gray;
  display: inline-block;
}
.footnote-mt-container.hover-select:hover .more-option-box {
  display: block;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line > first-line-prefix {
  padding-right: 0.3em;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl {
  direction: rtl;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl > first-line-prefix {
  padding-left: 0.3em;
}
.blocks-inline > math-edit-container > editarea > area-container > line > blocks {
  display: inline;
}

.lang-name:hover {
  background: #f7f7f7;
}
.lang-name.selected {
  background: #e1e8f5;
}
.custom-lange-area input::placeholder,
.custom-lange-area textarea::placeholder {
  color: lightgray;
}

.page-print-item {
  position: relative;
}
.page-print-item:hover .page-print-item-hover {
  display: block;
}
.page-print-item-hover {
  display: none;
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 10px;
  background: #f7f6f6;
  z-index: 10;
  padding: 5px;
  font-size: 0.8em;
  white-space: nowrap;
  color: gray;
  border: 1px solid lightgray;
}

.settings-show-hide {
  background: rgba(255, 255, 255, 0.61);
}
.settings-show-hide:hover {
  background: white;
}
.group-symbol-collapsed {
  display: block;
  border: 1px dotted lightgray;
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
.role-math-mode-group.math-mode-group-expanded .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded .settings-show-hide {
  display: none;
}
.role-math-mode-group.math-mode-group-expanded:hover,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover {
  outline: 1px solid lightgray;
}
.role-math-mode-group.math-mode-group-expanded:hover .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover .settings-show-hide {
  display: flex;
}

math-type compositeblock.text-super-script-symbol,
math-type compositeblock.text-sub-script-symbol {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode > blocks,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
math-type .text-super-script-symbol {
  vertical-align: super;
}
math-type .text-sub-script-symbol {
  vertical-align: sub;
}

compositeblock.section-ref {
  display: inline;
}
compositeblock.section-ref > .section-ref-border {
  display: inline;
  white-space: pre-wrap;
}
compositeblock.section-ref > div {
  display: inline;
}



icon-dropdown-items icon-dropdown-item:hover {
  background: #eae9e9;
}
icon-dropdown ii-icon {
  fill: gray;
}
icon-dropdown:hover {
  color: #4e4d4d;
}
icon-dropdown:hover ii-icon {
  fill: #4e4d4d;
}

resizable-container {
  display: block;
  position: relative;
  min-height: 0;
  flex-shrink: 0;
}





a.fce {
  cursor: pointer;
}
a.fce:hover svg {
  fill: #2d4373;
}
a.fce svg {
  fill: #3b5998;
}
a.fce i {
  text-align: center;
  color: white;
}
a.gg {
  cursor: pointer;
}
a.gg:hover svg {
  fill: #c23321;
}
a.gg svg {
  fill: #dd4b39;
}
a.gg i {
  text-align: center;
  color: white;
}
a.twr {
  cursor: pointer;
}
a.twr:hover svg {
  fill: #2795e9;
}
a.twr svg {
  fill: #55acee;
}
a.twr i {
  text-align: center;
  color: white;
}
a.gh {
  cursor: pointer;
}
a.gh:hover svg {
  fill: #2b2b2b;
}
a.gh svg {
  fill: #444;
}
a.gh i {
  text-align: center;
  color: white;
}





modal-dialog.swift.document-name modal-container.mt-common-dialog {
  width: 500px;
  max-width: 95vw;
}
modal-dialog.swift.document-name document-name {
  width: 100%;
  display: flex;
  flex-direction: column;
}
modal-dialog.swift.document-name document-name label {
  display: block;
  font-size: 13px;
}
modal-dialog.swift.document-name document-name textarea {
  width: auto;
  display: block;
  margin: 5px 0px;
  height: 39px;
  outline: none;
  border: 1px solid lightgray;
  resize: vertical;
}

.dock-tab-content {
  flex: 1;
  min-height: 0;
  min-width: 0;
  display: none;
}
.dock-tab-content.active {
  display: flex;
}

quick-start editarea.root-editor {
  min-height: 100px;
}
quick-start > qs-math-type-container > math-type:hover {
  border: 1px solid gray;
}
quick-start > qs-math-type-container > math-type tool-bar {
  display: none;
}
quick-start > qs-math-type-container > math-type items-bar {
  display: none;
  left: -60px;
  top: 0px;
  box-shadow: 0px 1px 2px 0px #4c4949;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
document-info-container document-info-bar {
  display: block;
  position: absolute;
  right: 15px;
  bottom: 5px;
  background: #f7f7f7;
  box-shadow: 1px 1px 1px 0px #e0dddd;
  border: 1px lightgray solid;
  font-size: 12px;
  padding: 0px;
  color: gray;
  opacity: 0.8;
  z-index: 4;
}
document-info-container document-info-bar:hover {
  opacity: 1;
}
document-info-container modal-container button.ok.btn-primary {
  display: none;
}
.Popover-body {
  font-size: 12px;
  padding: 10px;
  background: #4CAF50;
  box-shadow: #888686 1px 1px 1px 1px;
  color: white;
  max-width: 250px;
}
.Popover-tip {
  fill: #4CAF50;
}

/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
.doc-toolbar-container {
  position: relative;
  background: #f7f7f7;
  top: 0;
  left: 0;
  width: 100%;
  border: 1px lightgray solid;
  margin-left: -2px;
  z-index: 6;
}
.doc-toolbar-container > tool-bar {
  position: relative;
  top: 0;
  left: 0;
  display: block;
  padding-left: 0px;
  min-width: 770px;
  width: 770px;
  margin: auto;
  background: transparent;
  box-shadow: none;
  border: none;
  height: 35px;
}











/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/


</style><style>.cb--iframe--aMNCL_E1x046f6Be3ICM {
  all: unset;
  position: fixed;
  right: 0;
  top: 0;
  height: 100%;
  width: 352px;
  z-index: 1000000;
  background: white;
  border: none;
  box-shadow: -3px 2px 5px 2px rgba(0, 0, 0, 0.25);

  transition: right 0.3s ease-out;
}

.cb--closed--lebfAyUbHvSjo3AjhXsJ {
  right: -352px;
}

.cb--hidden--zswHA1e_s5V1Po8KlfTc {
  display: none;
}
</style><style>.cb--openCloseButton--oh3mkDsZMOZh8k0F040F,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F *:not(path) {
  all: unset;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F {
  position: fixed;
  right: 0px;
  z-index: 1000001;

  /* override default button styles */
  margin: 0;
  padding: 0;
  border: none;
  cursor: pointer;

  transition: right 0.3s ease-out;
  border-radius: 2px 0 0 2px;
  text-align: center;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F button {
  /* override default button styles */
  margin: 0;
  padding: 0;
  border: none;
  cursor: pointer;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz .cb--openToggleButton--mqbvYBMC__Itqt46E4EE {
  height: 48px;
  width: 48px;
  border-radius: 4px 0 0 4px;
  background: #0160ff;
}
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz .cb--whiteBackgroundWrapper--alUDtlB95PILj6sYYEyB {
  height: 48px;
  width: 48px;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--open--zhmNU_iy7dqGMYCa8hIX {
  right: 352px;
  width: 32px;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz {
  box-shadow: -2px 2px 5px 0px rgba(0, 0, 0, 0.25);
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--open--zhmNU_iy7dqGMYCa8hIX .cb--whiteBackgroundWrapper--alUDtlB95PILj6sYYEyB {
  background: white;
  border-radius: 2px 0 0 2px;
  box-shadow: -2px 2px 5px 0px rgba(0, 0, 0, 0.25);
  display: block;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--open--zhmNU_iy7dqGMYCa8hIX .cb--openToggleButton--mqbvYBMC__Itqt46E4EE,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--open--zhmNU_iy7dqGMYCa8hIX .cb--dismissButton--_Kw5IoLfNW6HCHmKxRfL {
  height: 32px;
  width: 32px;
  background: none;
}

.cb--logoContainer--Xe9DoJlDRdjn9fzukx3a svg {
  fill: white;
  padding: 8px;
}

.cb--closeIconContainer--S9Gso8D9iNvh_BhjjODH svg,
.cb--dismissButton--_Kw5IoLfNW6HCHmKxRfL svg,
.cb--gripperIcon--haVTZsHtE1KPXDZXKj03 svg {
  fill: #666666;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--open--zhmNU_iy7dqGMYCa8hIX .cb--logoContainer--Xe9DoJlDRdjn9fzukx3a,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz .cb--closeIconContainer--S9Gso8D9iNvh_BhjjODH,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--closed--_f_rBuFcBcTMLAaGn2Tz .cb--dismissButton--_Kw5IoLfNW6HCHmKxRfL {
  display: none;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F .cb--dismissButton--_Kw5IoLfNW6HCHmKxRfL svg {
  /* Shrink X icon size, it is too large compared to other icons at same width */
  width: 24px;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F .cb--gripperIcon--haVTZsHtE1KPXDZXKj03 {
  height: 24px;
  width: 32px;
  padding: 0;
  margin-top: 4px;
  margin-left: auto;
  margin-right: auto;
  display: none;
}

.cb--openCloseButton--oh3mkDsZMOZh8k0F040F:hover .cb--gripperIcon--haVTZsHtE1KPXDZXKj03,
.cb--openCloseButton--oh3mkDsZMOZh8k0F040F.cb--dragging--gCDPU69j53T3Du6wkUGE .cb--gripperIcon--haVTZsHtE1KPXDZXKj03 {
  display: block;
}
</style><style>.cb--how-to-open-ftux--lJiFBsjeGgv20UWXQQDq {
  all: unset;
  position: fixed;
  right: 0;
  top: 0;
  z-index: 1000000;
  width: 352px;
  background: white;
  border: none;
  box-shadow: -3px 2px 5px 2px rgba(0, 0, 0, 0.25);
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  color: black;

  font-family: "Roboto", Arial, sans-serif !important;
  font-size: 16px !important;
  font-weight: 400 !important;
  line-height: 24px !important;
}

.cb--close-icon--_TFa6uTtJfnGgIJTXFfY {
  all: unset;
  cursor: pointer;
  height: 24px;
  width: 24px;
  padding: 4px;
  border-radius: 4px;
  margin-left: auto;
  background: white;
}

.cb--ftux-message--Eza1NHUnXuU6o5z9q9RE {
  margin: 0 20px 20px 20px;
}

.cb--cb-icon--EmIuD7INmg1Wo_QQRXk0 {
  display: inline-block;
  height: 24px;
  width: 24px;
  border-radius: 4px;
  background: #0160ff;
  color: white;
  vertical-align: bottom;
}

.cb--cb-icon--EmIuD7INmg1Wo_QQRXk0 svg {
  fill: white;
  margin: 4px;
}
</style><style>@keyframes resizeanim { from { opacity: 0; } to { opacity: 0; } } .resize-triggers { animation: 1ms resizeanim; visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }</style></head><body style="overflow:auto;background:rgb(255, 255, 255);width:auto;height:auto;"><editor-container style="display:block;margin:auto;width:794px;"><math-type style="user-select:text;" class=" math-type-for-print "><math-edit-container><editarea class="root-editor" style="font-family: &quot;Computer Modern Sans&quot;, serif; font-size: 17px;"><area-baseline aria-hidden="true">a</area-baseline><area-container><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold; font-size: 1.73em;">Text Classification</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold; font-size: 1.2em;"><div data-id="n0.3033023006773121" class="anchor-tag-border no-border-on-print" id="n0.3033023006773121"><span>Table of Content</span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="table-of-content inline"><toc-wrapper style="opacity: 1;"><editarea class="edit-area toc-ea no-area-container text-mode"><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.343946166451788" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.343946166451788" style="display: inline-block; white-space: pre;">1. </span></compositeblock><block>Introduction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 547.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L547.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.5472215162068952" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5472215162068952" style="display: inline-block; white-space: pre;">2. </span></compositeblock><block>Step 1: Gather Data</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 489.969px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L489.96875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.2725786440827722" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2725786440827722" style="display: inline-block; white-space: pre;">3. </span></compositeblock><block>Explore Your Data</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 503.297px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L503.296875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7878747343723229" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7878747343723229" style="display: inline-block; white-space: pre;">3.1. </span></compositeblock><block>Checking the Data</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 488.438px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L488.4375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.5668507791467565" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5668507791467565" style="display: inline-block; white-space: pre;">3.2. </span></compositeblock><block>Collect Key Metrics</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 481.656px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L481.65625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.8131833603014174" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8131833603014174" style="display: inline-block; white-space: pre;">4. </span></compositeblock><block>Choose a Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 519.688px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L519.6875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.2707728417538402" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2707728417538402" style="display: inline-block; white-space: pre;">4.1. </span></compositeblock><block>Algorithm for Data Preparation and Model Building</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 252.891px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L252.890625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6830057438983175" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6830057438983175" style="display: inline-block; white-space: pre;">5. </span></compositeblock><block>Prepare Your Data</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 501.461px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L501.4609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.4332581220504228" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.4332581220504228" style="display: inline-block; white-space: pre;">5.1. </span></compositeblock><block>N-gram vectors [Option A]</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 431.352px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L431.3515625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.1737505331138176" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1737505331138176" style="display: inline-block; white-space: pre;">5.1.1. </span></compositeblock><block>Tokenization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 518.219px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L518.21875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.2654718728164822" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2654718728164822" style="display: inline-block; white-space: pre;">5.1.2. </span></compositeblock><block>Vectorization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 515.109px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L515.109375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.3479593261859235" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3479593261859235" style="display: inline-block; white-space: pre;">5.1.3. </span></compositeblock><block>Feature Selection</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 485.664px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L485.6640625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.20971649962724914" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.20971649962724914" style="display: inline-block; white-space: pre;">5.1.4. </span></compositeblock><block>Normalization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 509.453px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L509.453125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.560929472589341" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.560929472589341" style="display: inline-block; white-space: pre;">5.2. </span></compositeblock><block>Sequence Vectors [Option B]</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 416px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L416,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.4258600810601705" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.4258600810601705" style="display: inline-block; white-space: pre;">5.2.1. </span></compositeblock><block>Tokenization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 518.219px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L518.21875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.12295462827015657" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.12295462827015657" style="display: inline-block; white-space: pre;">5.2.2. </span></compositeblock><block>Vectorization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 515.109px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L515.109375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.9698332774588398" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9698332774588398" style="display: inline-block; white-space: pre;">5.2.3. </span></compositeblock><block>Feature Selection</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 485.664px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L485.6640625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; cursor: pointer;"><a href="#n0.05050498647346635" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.05050498647346635" style="display: inline-block; white-space: pre;">5.2.4. </span></compositeblock><block>Label vectorization</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 474.227px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L474.2265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.03902828783514489" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.03902828783514489" style="display: inline-block; white-space: pre;">6. </span></compositeblock><block>Build, Train, and Evaluate Your Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 358.969px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L358.96875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.8389514852267814" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8389514852267814" style="display: inline-block; white-space: pre;">6.1. </span></compositeblock><block>Constructing the Last Layer</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 423.836px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L423.8359375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.338509452800412" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.338509452800412" style="display: inline-block; white-space: pre;">6.2. </span></compositeblock><block>Build n-gram model [Option A]</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 398.438px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L398.4375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7059517408126226" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7059517408126226" style="display: inline-block; white-space: pre;">6.3. </span></compositeblock><block>Build sequence model [Option B]</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 385.797px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L385.796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; cursor: pointer;"><a href="#n0.17677525581721" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.17677525581721" style="display: inline-block; white-space: pre;">6.4. </span></compositeblock><block>Train Your Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 495.797px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L495.796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6843902676744793" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6843902676744793" style="display: inline-block; white-space: pre;">7. </span></compositeblock><block>Tune Hyperparameters</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 473.664px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L473.6640625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.1976119444091633" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1976119444091633" style="display: inline-block; white-space: pre;">8. </span></compositeblock><block>Deploy Your Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 497.469px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L497.46875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line></editarea></toc-wrapper></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.343946166451788" id="n0.343946166451788" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Introduction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Heres a high-level overview of the workflow used to solve machine learning problems:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 1:</block><block> Gather Data</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 2:</block><block> Explore Your Data</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 2.5:</block><block> Choose a Model*</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Choose a model is not a formal step of the traditional machine learning workflow; however, selecting an appropriate model for your problem is a critical task that clarifies and simplifies the work in the steps that follow.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 3:</block><block> Prepare Your Data</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 4:</block><block> Build, Train, and Evaluate Your Model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 5:</block><block> Tune Hyperparameters</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Step 6:</block><block> Deploy Your Model</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 608px; height: 112.79px; position: relative;"><img src="image-resources/cc894249-b68b-45a8-8a76-7e6f3d4944c0.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.5472215162068952" id="n0.5472215162068952" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Step 1: Gather Data</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Your text classifier can only be as good as the dataset it is built from.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If you dont have a specific problem you want to solve and are just interested in exploring text classification in general, there are plenty of open source datasets available. You can find links to some of them in our </block><block class="role-hyper-link" data-hyper-link-url="https://github.com/google/eng-edu/blob/master/ml/guides/text_classification/load_data.py" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://github.com/google/eng-edu/blob/master/ml/guides/text_classification/load_data.py" target="_blank" style="color: inherit; text-decoration: inherit;">GitHub repo</a></block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>On the other hand, if you are tackling a specific problem, you will need to collect the necessary data. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Many organizations provide public APIs for accessing their datafor example, the Twitter API or the NY Times API. You may be able to leverage these for the problem you are trying to solve.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Throughout this guide, we will use the </block><block class="role-hyper-link" data-hyper-link-url="http://ai.stanford.edu/~amaas/data/sentiment/" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="http://ai.stanford.edu/~amaas/data/sentiment/" target="_blank" style="color: inherit; text-decoration: inherit;">Internet Movie Database (IMDb)</a></block><block> movie reviews dataset to illustrate the workflow.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here are some important things to remember when collecting data:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If you are using a public API, </block><block style="background-color: rgba(248, 231, 28, 0.3);">understand the limitations of the API</block><block> before using them. For example, some APIs set a limit on the rate at which you can make queries.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="background-color: rgba(248, 231, 28, 0.3);">more training examples</block><block> (referred to as samples in the rest of this guide) you have, </block><block style="background-color: rgba(248, 231, 28, 0.3);">the better</block><block>. This will help your model generalize better.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Make sure the number of samples for every class or topic is not overly </block><block style="background-color: rgba(248, 231, 28, 0.3);">imbalanced</block><block>. That is, you should have comparable number of samples in each class.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Make sure that your samples adequately </block><block style="background-color: rgba(248, 231, 28, 0.3);">cover the space of possible inputs</block><block>, </block><block style="background-color: rgba(248, 231, 28, 0.3);">not only the common cases</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35); font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.2725786440827722" id="n0.2725786440827722" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Explore Your Data</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Building and training a model is only one part of the workflow. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Understanding the characteristics of your data beforehand will enable you to build a better model. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This could simply mean obtaining a higher accuracy. It could also mean requiring less data for training, or fewer computational resources.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>First up, lets load the dataset into Python.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">load_imdb_sentiment_analysis_dataset</block><block class="punctuation token">(</block><block class=" token">data_path</block><block class="punctuation token">,</block><block class=" token"> seed</block><block class="operator token">=</block><block class="number token">123</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Loads the IMDb movie reviews sentiment analysis dataset.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        data_path: string, path to the data directory.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        seed: int, seed for randomizer.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        A tuple of training and validation data.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Number of training samples: 25000</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Number of test samples: 25000</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Number of categories: 2 (0 - negative, 1 - positive)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # References</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Mass et al., http://www.aclweb.org/anthology/P11-1015</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Download and uncompress archive from:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        http://ai.stanford.edu/~amaas/data/sentiment/aclImdb_v1.tar.gz</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    imdb_data_path </block><block class="operator token">=</block><block class=" token"> os</block><block class="punctuation token">.</block><block class=" token">path</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">data_path</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'aclImdb'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Load the training data</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    train_texts </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    train_labels </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> category </block><block class="keyword token">in</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">'pos'</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'neg'</block><block class="punctuation token">]</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        train_path </block><block class="operator token">=</block><block class=" token"> os</block><block class="punctuation token">.</block><block class=" token">path</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">imdb_data_path</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'train'</block><block class="punctuation token">,</block><block class=" token"> category</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> fname </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">os</block><block class="punctuation token">.</block><block class=" token">listdir</block><block class="punctuation token">(</block><block class=" token">train_path</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> fname</block><block class="punctuation token">.</block><block class=" token">endswith</block><block class="punctuation token">(</block><block class="string token">'.txt'</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">with</block><block class=" token"> </block><block class="builtin token">open</block><block class="punctuation token">(</block><block class=" token">os</block><block class="punctuation token">.</block><block class=" token">path</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">train_path</block><block class="punctuation token">,</block><block class=" token"> fname</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> f</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    train_texts</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class=" token">f</block><block class="punctuation token">.</block><block class=" token">read</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                train_labels</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="number token">0</block><block class=" token"> </block><block class="keyword token">if</block><block class=" token"> category </block><block class="operator token">==</block><block class=" token"> </block><block class="string token">'neg'</block><block class=" token"> </block><block class="keyword token">else</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Load the validation data.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    test_texts </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    test_labels </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> category </block><block class="keyword token">in</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">'pos'</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'neg'</block><block class="punctuation token">]</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        test_path </block><block class="operator token">=</block><block class=" token"> os</block><block class="punctuation token">.</block><block class=" token">path</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">imdb_data_path</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'test'</block><block class="punctuation token">,</block><block class=" token"> category</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> fname </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">os</block><block class="punctuation token">.</block><block class=" token">listdir</block><block class="punctuation token">(</block><block class=" token">test_path</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> fname</block><block class="punctuation token">.</block><block class=" token">endswith</block><block class="punctuation token">(</block><block class="string token">'.txt'</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">with</block><block class=" token"> </block><block class="builtin token">open</block><block class="punctuation token">(</block><block class=" token">os</block><block class="punctuation token">.</block><block class=" token">path</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">test_path</block><block class="punctuation token">,</block><block class=" token"> fname</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> f</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    test_texts</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class=" token">f</block><block class="punctuation token">.</block><block class=" token">read</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                test_labels</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="number token">0</block><block class=" token"> </block><block class="keyword token">if</block><block class=" token"> category </block><block class="operator token">==</block><block class=" token"> </block><block class="string token">'neg'</block><block class=" token"> </block><block class="keyword token">else</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Shuffle the training data and labels.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    random</block><block class="punctuation token">.</block><block class=" token">seed</block><block class="punctuation token">(</block><block class=" token">seed</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    random</block><block class="punctuation token">.</block><block class=" token">shuffle</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    random</block><block class="punctuation token">.</block><block class=" token">seed</block><block class="punctuation token">(</block><block class=" token">seed</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    random</block><block class="punctuation token">.</block><block class=" token">shuffle</block><block class="punctuation token">(</block><block class=" token">train_labels</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">,</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">array</block><block class="punctuation token">(</block><block class=" token">train_labels</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="punctuation token">(</block><block class=" token">test_texts</block><block class="punctuation token">,</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">array</block><block class="punctuation token">(</block><block class=" token">test_labels</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.7878747343723229" id="n0.7878747343723229" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Checking the Data</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>After loading the data, its good practice to run some checks on it: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Pick a few samples and </block><block style="background-color: rgba(248, 231, 28, 0.3);">manually check</block><block> if they are consistent with your expectations. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">For example,</block><block> print a few random samples to see if the sentiment label corresponds to the sentiment of the review. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here is a review we picked at random from the IMDb dataset: Ten minutes worth of story stretched out into the better part of two hours. When nothing of any significance had happened at the halfway point I should have left. The expected sentiment (negative) matches the samples label.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.5668507791467565" id="n0.5668507791467565" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Collect Key Metrics</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once youve verified the data, collect the following important metrics that can help characterize your text classification problem:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of samples:</block><block> Total number of examples you have in the data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of classes:</block><block> Total number of topics or categories in the data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of samples per class:</block><block> Number of samples per class (topic/category). In a balanced dataset, all classes will have a similar number of samples; in an imbalanced dataset, the number of samples in each class will vary widely.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of words per sample:</block><block> Median number of words in one sample.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Frequency distribution of words:</block><block> Distribution showing the frequency (number of occurrences) of each word in the dataset.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Distribution of sample length:</block><block> Distribution showing the number of words per sample in the dataset.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Lets see what the values for these metrics are for the IMDb reviews dataset:</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 657.25px; height: 163px; position: relative;"><img src="image-resources/4f1d0054-5122-4f8d-bd4e-0c3d409abdd8.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.5192569886771441" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.5192569886771441"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span>Table 1</span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>IMDb reviews dataset metrics</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-family: &quot;Computer Modern Typewriter&quot;, serif; color: rgb(255, 0, 32);">explore_data.py</block><block> contains functions to calculate and analyze these metrics. Here are a couple of examples:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> numpy </block><block class="keyword token">as</block><block class=" token"> np</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> matplotlib</block><block class="punctuation token">.</block><block class=" token">pyplot </block><block class="keyword token">as</block><block class=" token"> plt</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_num_words_per_sample</block><block class="punctuation token">(</block><block class=" token">sample_texts</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Returns the median number of words per sample given corpus.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        sample_texts: list, sample texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        int, median number of words per sample.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    num_words </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">s</block><block class="punctuation token">.</block><block class=" token">split</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> s </block><block class="keyword token">in</block><block class=" token"> sample_texts</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">median</block><block class="punctuation token">(</block><block class=" token">num_words</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">plot_sample_length_distribution</block><block class="punctuation token">(</block><block class=" token">sample_texts</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Plots the sample length distribution.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        samples_texts: list, sample texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">hist</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">s</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> s </block><block class="keyword token">in</block><block class=" token"> sample_texts</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">50</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">xlabel</block><block class="punctuation token">(</block><block class="string token">'Length of a sample'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">ylabel</block><block class="punctuation token">(</block><block class="string token">'Number of samples'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">title</block><block class="punctuation token">(</block><block class="string token">'Sample length distribution'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">show</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 703.125px; height: 403.07px; position: relative;"><img src="image-resources/e6769edd-eb28-4085-bfc8-2cdded6247e0.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.3212041239037222" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.3212041239037222"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 35512 --> <!-- /react-text --><!-- react-text: 35513 -->2<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Frequency distribution of words for IMDb</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 666.094px; height: 373.85px; position: relative;"><img src="image-resources/99314087-5acb-4845-8f3b-99aff6494307.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.42252732616373145" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.42252732616373145"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 35622 --> <!-- /react-text --><!-- react-text: 35623 -->3<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Distribution of sample length for IMDb</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.8131833603014174" id="n0.8131833603014174" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Choose a Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Next, based on the metrics we gathered in Step 2, we should think about which classification model we should use. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This means asking questions such as:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>How do we present the text data to an algorithm that expects numeric input? (this is called </block><block style="font-weight: bold;">data preprocessing</block><block> and </block><block style="font-weight: bold; color: rgb(208, 2, 27);">vectorization</block><block>) </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block> "What type of model should we use?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>What configuration parameters should we use for our model?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>etc.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this guide, we attempt to significantly simplify the process of selecting a text classification model. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For a given dataset, our goal is to find the algorithm that achieves close to maximum accuracy while minimizing computation time required for training. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We ran a large number (~450K) of experiments across problems of different types (especially sentiment analysis and topic classification problems), using 12 datasets, alternating for each dataset between different data preprocessing techniques and different model architectures. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This helped us identify dataset parameters that influence optimal choices.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">model selection algorithm</block><block> and flowchart below are a summary of our experimentation.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.2707728417538402" id="n0.2707728417538402" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Algorithm for Data Preparation and Model Building</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="boxed-container inline" style="display: block;"><div style="border-style: solid; border-width: 1px; padding: 1em; margin-top: 0.1em; margin-bottom: 0.1em; border-color: transparent; border-radius: 20px; background: rgba(155, 155, 155, 0.2);"><editarea class="text-mode"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">1. Calculate the number of samples/number of words per sample ratio.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">2. If this ratio is less than 1500, tokenize the text as n-grams and use a</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">simple multi-layer perceptron (MLP) model to classify them (left branch in the</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">flowchart below):</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  a. Split the samples into word n-grams; convert the n-grams into vectors.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  b. Score the importance of the vectors and then select the top 20K using the scores.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  c. Build an MLP model.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">3. If the ratio is greater than 1500, tokenize the text as sequences and use a</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">   </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; color: rgb(255, 3, 33); font-weight: bold;">sepCNN</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;"> model to classify them (right branch in the flowchart below):</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  a. Split the samples into words; select the top 20K words based on their frequency.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  b. Convert the samples into word sequence vectors.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">  c. If the original number of samples/number of words per sample ratio is less</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">     than 15K, using a fine-tuned pre-trained embedding with the </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(255, 3, 33);">sepCNN</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">     model will likely provide the best results.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">4. Measure the model performance with different hyperparameter values to find</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">   the best model configuration for the dataset.</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the flowchart below:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(227, 214, 53);">Yellow boxes</block><block>  data and model preparation processes. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(155, 155, 155);">Grey boxes</block><block>  choices we considered for each process. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(126, 211, 33);">Green boxes</block><block>  our recommended choice for each process.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can </block><block style="background-color: rgba(248, 231, 28, 0.3);">use this flowchart as a starting point to construct your first experiment</block><block>, as it will give you good accuracy at low computation costs. You can then continue to improve on your initial model over the subsequent iterations.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 675.25px; height: 948.58px; position: relative;"><img src="image-resources/c4125839-c6db-4914-b7a2-12cebf14a8c0.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.4939008728409129" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.4939008728409129"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 39454 --> <!-- /react-text --><!-- react-text: 39455 -->4<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Text classification flowchart</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This flowchart answers two key questions:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-weight: bold;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Which learning algorithm or model should we use?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-weight: bold;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">How should we prepare the data to efficiently learn the relationship between text and label?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">The answer to the second question depends on the answer to the first question.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The way we preprocess data to be fed into a model will depend on what model we choose. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Models can be broadly classified into </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">two categories</block><block>: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Those that use </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">word ordering information</block><block> (</block><block style="font-weight: bold; color: rgb(208, 2, 27);">sequence models</block><block>), </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Those that just </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">see text as bags (sets) of words</block><block> (</block><block style="font-weight: bold; color: rgb(208, 2, 27);">n-gram models</block><block>). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Types of </block><block style="font-weight: bold; color: rgb(208, 2, 27);">sequence models</block><block> include:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="">Convolutional neural networks (CNNs)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="">Recurrent neural networks (RNNs)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>And their variations. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Types of </block><block style="font-weight: bold; color: rgb(208, 2, 27);">n-gram models</block><block> include:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Logistic regression</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Simple multi-layer perceptrons (MLPs, or fully-connected neural networks)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>gradient boosted trees </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>support vector machines</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>From our experiments, we have observed that the ratio of number of samples </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">(S)</block><block> to number of words per sample </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">(W)</block><block> </block><block style="background-color: rgba(248, 231, 28, 0.3);">correlates with which model performs well</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">When the value for this ratio is small (</block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mo form=&quot;infix&quot;>&amp;lt;</mo><mn>1500</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Relation">&lt;</block><block class="Normal">1500</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mo form="infix">&lt;</mo><mn>1500</mn></mrow></mstyle></math></span></compositeblock><block style="background-color: rgba(248, 231, 28, 0.3);">):</block><block> </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Small </block><block style="font-weight: bold;">multi-layer perceptrons</block><block> that take </block><block style="font-weight: bold;">n-grams</block><block> as input (which we'll call Option A) perform better or at least as well as sequence models. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>MLPs are simple to define and understand, and they take much less compute time than sequence models. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">When the value for this ratio is large (</block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mo form=&quot;infix&quot;></mo><mn>1500</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Relation"></block><block class="Normal">1500</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mo form="infix"></mo><mn>1500</mn></mrow></mstyle></math></span></compositeblock><block style="background-color: rgba(248, 231, 28, 0.3);">):</block><block> </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use a </block><block style="font-weight: bold;">sequence model</block><block> (Option B). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the steps that follow, you can skip to the relevant subsections (labeled A or B) for the model type you chose based on the samples/words-per-sample ratio.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the case of our IMDb review dataset, the samples/words-per-sample ratio is </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>~</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">~</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>~</mi></mstyle></math></span></compositeblock><block>144. This means that we will create a MLP model.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(144, 19, 254); font-weight: bold;">Note:</block><block style="font-style: italic; color: rgb(128, 128, 128);"> When using the above flowchart, keep in mind that </block><block style="font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);">it may not necessarily lead you to the most optimal results for your problem</block><block style="font-style: italic; color: rgb(128, 128, 128);">, for several reasons:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(128, 128, 128); font-weight: bold;">Your goal may be different</block><block style="font-style: italic; color: rgb(128, 128, 128);">. We optimized for the best accuracy that could be achieved in the shortest possible compute time. An alternate flow may produce a better result, say, when optimizing for area under the curve (AUC).</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(128, 128, 128); font-weight: bold;">We picked typical and common algorithm choices</block><block style="font-style: italic; color: rgb(128, 128, 128);">. As the field continues to evolve, new cutting-edge algorithms and enhancements may be relevant to your data and may perform better.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(128, 128, 128);">While we used several datasets to derive and validate the flowchart, </block><block style="font-weight: bold; font-style: italic; color: rgb(128, 128, 128);">there may be specific characteristics to your dataset</block><block style="font-style: italic; color: rgb(128, 128, 128);"> that favor using an alternate flow.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="boxed-container inline" style="display: block;"><div style="border-style: solid; border-width: 1px; padding: 1em; margin-top: 0.1em; margin-bottom: 0.1em; border-color: transparent; border-radius: 20px; background: rgba(128, 128, 128, 0.2);"><editarea class="text-mode"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold; font-size: 1.2em;">ROC (receiver operating characteristic) Curve</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">A graph of true positive rate vs. false positive rate for different classification thresholds in binary classification.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">The shape of an ROC curve suggests a binary classification model's ability to separate positive classes from negative classes. Suppose, for example, that a binary classification model perfectly separates all the negative classes from all the positive classes:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 615.875px; height: 140.24px; position: relative;"><img src="image-resources/e64a80a6-7c31-433b-bae2-0683716e7937.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">The ROC curve for the preceding model looks as follows:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 347px; height: 317.31px; position: relative;"><img src="image-resources/c8953740-b495-4290-98f7-eae1756d89f8.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">In contrast, the following illustration graphs the raw logistic regression values for a terrible model that can't separate negative classes from positive classes at all:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 610.375px; height: 141.37px; position: relative;"><img src="image-resources/e078b540-d580-4db7-a637-033cbe6aacc4.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">The ROC curve for this model looks as follows:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 359px; height: 334px; position: relative;"><img src="image-resources/bbcca96a-06b8-42e2-91bc-98e99d59887c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Meanwhile, back in the real world, most binary classification models separate positive and negative classes to some degree, but usually not perfectly. So, a typical ROC curve falls somewhere between the two extremes:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 380.5px; height: 313.5px; position: relative;"><img src="image-resources/dde4613d-9ab0-4975-93b7-b7598d52dfb8.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">The point on an ROC curve closest to (0.0,1.0) theoretically identifies the ideal classification threshold. However, several other real-world issues influence the selection of the ideal classification threshold. For example, perhaps false negatives cause far more pain than false positives.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">A numerical metric called AUC summarizes the ROC curve into a single floating-point value.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.2em; font-weight: bold;">AUC (Area Under the ROC Curve)</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">A number between 0.0 and 1.0 representing a binary classification model's ability to separate positive classes from negative classes. The closer the AUC is to 1.0, the better the model's ability to separate classes from each other.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">For example, the following illustration shows a classifier model that separates positive classes (green ovals) from negative classes (purple rectangles) perfectly. This unrealistically perfect model has an AUC of 1.0:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 625.375px; height: 125.22px; position: relative;"><img src="image-resources/575267e1-719c-4488-926b-b4023ab6d3d3.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Conversely, the following illustration shows the results for a classifier model that generated random results. This model has an AUC of 0.5:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 629.625px; height: 84.3px; position: relative;"><img src="image-resources/7a28c45f-8fbf-49b9-9c6b-5cd2132c9e88.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Yes, the preceding model has an AUC of 0.5, not 0.0.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Most models are somewhere between the two extremes. For instance, the following model separates positives from negatives somewhat, and therefore has an AUC somewhere between 0.5 and 1.0:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 644.125px; height: 78.81px; position: relative;"><img src="image-resources/a0f46746-a997-4234-858c-342751de5a1c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">AUC ignores any value you set for classification threshold. Instead, AUC considers all possible classification thresholds.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.2em; font-weight: bold;">Relationship Between ROC and AUC</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">AUC represents the area under an ROC curve. For example, the ROC curve for a model that perfectly separates positives from negatives looks as follows:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 348.5px; height: 316.65px; position: relative;"><img src="image-resources/61e25763-ac06-4ab6-b008-1f689c38e69d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">AUC is the area of the gray region in the preceding illustration. In this unusual case, the area is simply the length of the gray region (1.0) multiplied by the width of the gray region (1.0). So, the product of 1.0 and 1.0 yields an AUC of exactly 1.0, which is the highest possible AUC score.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Conversely, the ROC curve for a classifier that can't separate classes at all is as follows. The area of this gray region is 0.5.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 370px; height: 338.26px; position: relative;"><img src="image-resources/a035ef81-09b6-4e7e-81bf-ef4124e75f2b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">A more typical ROC curve looks approximately like the following:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 401px; height: 316.86px; position: relative;"><img src="image-resources/620ebd54-e494-450e-a2f9-15c42d5a28a6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">It would be painstaking to calculate the area under this curve manually, which is why a program typically calculates most AUC values.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold; font-size: 1.2em;">Formal Definition of AUC</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">AUC is the probability that a classifier will be more confident that a randomly chosen positive example is actually positive than that a randomly chosen negative example is positive.</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.6830057438983175" id="n0.6830057438983175" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Prepare Your Data</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Before our data can be fed to a model, it needs to be transformed to a format the model can understand.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>First, the data samples that we have </block><block style="font-weight: bold;">gathered may be in a specific order</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">We do not want any information associated with the ordering of samples to influence the relationship between texts and labels</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">For example,</block><block> if a dataset is sorted by class and is then split into training/validation sets, these sets will not be representative of the overall distribution of data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="background-color: rgba(248, 231, 28, 0.3);">simple best practice to ensure the model is not affected by data order</block><block> is to </block><block style="font-weight: bold;">always shuffle the data before doing anything else</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If your data is </block><block style="background-color: rgba(248, 231, 28, 0.3);">already split</block><block> into training and validation sets, </block><block style="background-color: rgba(248, 231, 28, 0.3);">make sure to transform your validation data the same way you transform your training data</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If you dont already have separate training and validation sets, you can </block><block style="background-color: rgba(248, 231, 28, 0.3);">split the samples after shuffling</block><block>; its typical to use 80% of the samples for training and 20% for validation.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Second, machine learning algorithms take numbers as inputs. This means that we will need to convert the texts into numerical vectors. There are two steps to this process:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">Tokenization:</block><block> Divide the texts into words or smaller sub-texts, which will enable good generalization of relationship between the texts and the labels. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This determines the </block><block style="font-weight: bold; color: rgb(208, 2, 27);">vocabulary</block><block> of the dataset (set of unique tokens present in the data).</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">Vectorization:</block><block> Define a good numerical measure to characterize these texts.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Lets see how to perform these two steps for both </block><block style="font-weight: bold; color: rgb(208, 2, 27);">n-gram</block><block> </block><block style="font-weight: bold; color: rgb(208, 2, 27);">vectors</block><block> and </block><block style="font-weight: bold; color: rgb(208, 2, 27);">sequence vectors</block><block>, as well as how to optimize the vector representations using feature selection and normalization techniques.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.4332581220504228" id="n0.4332581220504228" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>N-gram vectors [Option A]</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In an </block><block style="font-weight: bold;">n-gram vector</block><block>, text is represented as a </block><block style="background-color: rgba(248, 231, 28, 0.3);">collection of unique n-grams</block><block>: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Groups of </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>n</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>n</mi></mstyle></math></span></compositeblock><block> adjacent tokens (typically, words). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Consider the text "</block><block style="font-style: italic;">The mouse ran up the clock"</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here, the word </block><block style="font-weight: bold;">unigrams</block><block> (n = 1) are </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">['the', 'mouse', 'ran', 'up', 'clock']</block><block>, the word </block><block style="font-weight: bold;">bigrams</block><block> (n = 2) are </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">['the mouse', 'mouse ran', 'ran up', 'up the', 'the clock']</block><block>, and so on.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.1737505331138176" id="n0.1737505331138176" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tokenization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We have found that tokenizing into word unigrams + bigrams provides good accuracy while taking less compute time.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.2654718728164822" id="n0.2654718728164822" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.1.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Vectorization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once we have split our text samples into </block><block style="font-style: italic;">n-grams</block><block>, we need to </block><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">turn these n-grams into numerical vectors</block><block> that our machine learning models can process. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The example below shows the indexes assigned to the unigrams and bigrams generated for two texts.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Texts</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'The mouse ran up the clock'</block><block class=" token"> and </block><block class="string token">'The mouse ran down'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Index assigned </block><block class="keyword token">for</block><block class=" token"> every token</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">'the'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">7</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'mouse'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'ran'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">4</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'up'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">10</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="string token">'clock'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'the mouse'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">9</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'mouse ran'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'ran up'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">6</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'up the'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">11</block><block class="punctuation token">,</block><block class=" token"> 'the</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">clock</block><block class="string token">': 8, '</block><block class=" token">down</block><block class="string token">': 1, '</block><block class=" token">ran down'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">5</block><block class="punctuation token">}</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once indexes are assigned to the n-grams, we typically vectorize using one of the following options.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">One-hot encoding:</block><block> Every sample text is represented as a vector indicating the presence or absence of a token in the text.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="string token">'The mouse ran up the clock'</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">Count encoding:</block><block> Every sample text is represented as a vector indicating the count of a token in the text. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Note</block><block> that the element corresponding to the </block><block style="font-style: italic;">unigram</block><block> 'the' (bolded below) now is represented as 2 because the word the appears twice in the text.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="string token">'The mouse ran up the clock'</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27); text-decoration: underline;" class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Tf%e2%80%93idf"><a href="https://en.wikipedia.org/wiki/Tf%e2%80%93idf" target="_blank" style="color: inherit; text-decoration: inherit;">Tf-idf encoding</a></block><block style="font-weight: bold; color: rgb(208, 2, 27);">:</block><block> The </block><block style="font-weight: bold;">problem</block><block> with the above two approaches is that </block><block style="background-color: rgba(248, 231, 28, 0.3);">common words that occur in similar frequencies in all documents</block><block> (i.e., words that are not particularly unique to the text samples in the dataset) are not penalized. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">For example,</block><block> words like a will occur very frequently in all texts. So a higher token count for the than for other more meaningful words is not very useful.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="string token">'The mouse ran up the clock'</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">0.33</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.23</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.23</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.23</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.33</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.47</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.33</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="number token">0.23</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.33</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.33</block><block class="punctuation token">]</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">See Scikit</block><block class="operator token">-</block><block class=" token">learn TfidfTransformer</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are many other vector representations, but the above three are the most commonly used.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(144, 19, 254); font-weight: bold;">Note:</block><block style="font-style: italic; color: rgb(128, 128, 128);"> We observed that </block><block style="font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);">tf-idf encoding is </block><block style="font-weight: bold; font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);">marginally better</block><block style="font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);"> than the other two in terms of accuracy</block><block style="font-style: italic; color: rgb(128, 128, 128);"> (on average: 0.25-15% higher), and recommend using this method for vectorizing n-grams. However, keep in mind that </block><block style="font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);">it occupies more memory</block><block style="font-style: italic; color: rgb(128, 128, 128);"> (as it uses floating-point representation) and </block><block style="font-style: italic; color: rgb(128, 128, 128); background-color: rgba(248, 231, 28, 0.2);">takes more time to compute</block><block style="font-style: italic; color: rgb(128, 128, 128);">, especially for large datasets (can take twice as long in some cases).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.3479593261859235" id="n0.3479593261859235" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.1.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Feature Selection</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When we convert all of the texts in a dataset into word </block><block style="font-style: italic;">uni+bigram</block><block> tokens, we may end up with tens of thousands of tokens. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Not all of these tokens/features contribute to label prediction</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>So we can </block><block style="background-color: rgba(248, 231, 28, 0.3);">drop certain tokens</block><block>, for instance those that </block><block style="font-weight: bold;">occur extremely rarely</block><block> across the dataset. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can also measure </block><block style="font-weight: bold;">feature importance</block><block> (how much each token contributes to label predictions), and only include the most informative tokens.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are many statistical functions that take features and the corresponding labels and output the feature importance score. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Two commonly used functions are:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-weight: bold; font-style: italic;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic; background-color: rgba(245, 166, 35, 0.2);">f_classif</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-weight: bold; font-style: italic;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic; background-color: rgba(245, 166, 35, 0.2);">chi2</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Our experiments show that </block><block style="background-color: rgba(248, 231, 28, 0.3);">both of these functions perform equally well</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>More importantly, we saw that </block><block style="background-color: rgba(248, 231, 28, 0.3);">accuracy peaks at around 20,000 features for many datasets</block><block> (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.651419081290951"><a href="#n0.651419081290951" style="color: inherit; text-decoration: inherit;">Figure 5</a></span></compositeblock><block>). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Adding more features over this threshold contributes very little and sometimes even leads to overfitting and degrades performance.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 650.75px; height: 362.2px; position: relative;"><img src="image-resources/43f63e15-d93e-4f01-a531-bbc7deec8044.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.651419081290951" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.651419081290951"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 53048 --> <!-- /react-text --><!-- react-text: 53049 -->5<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.8em; font-weight: bold;">Top K features versus Accuracy</block><block style="font-size: 0.8em;">. Across datasets, accuracy plateaus at around top 20K features.</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.20971649962724914" id="n0.20971649962724914" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.1.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Normalization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Normalization </block><block style="background-color: rgba(248, 231, 28, 0.3);">converts all feature/sample values to small and similar values</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This </block><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">simplifies gradient descent convergence</block><block> in learning algorithms. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">From what we have seen, normalization during data preprocessing does not seem to add much value in text classification problems; </block><block style="font-weight: bold; color: rgb(208, 2, 27); background-color: rgba(248, 231, 28, 0.3);">we recommend skipping this step</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following code puts together all of the above steps:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Tokenize</block><block> text samples into word uni+bigrams,</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Vectorize</block><block> using tf-idf encoding,</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Select only</block><block> the top 20,000 features from the vector of tokens by discarding tokens that appear fewer than 2 times and using </block><block style="font-weight: bold; font-style: italic;">f_classif</block><block> to calculate feature importance.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">feature_extraction</block><block class="punctuation token">.</block><block class=" token">text </block><block class="keyword token">import</block><block class=" token"> TfidfVectorizer</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">feature_selection </block><block class="keyword token">import</block><block class=" token"> SelectKBest</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">feature_selection </block><block class="keyword token">import</block><block class=" token"> f_classif</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Vectorization parameters</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Range (inclusive) of n-gram sizes for tokenizing text.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">NGRAM_RANGE </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Limit on the number of features. We use the top 20K features.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">TOP_K </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">20000</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Whether text should be split into word or character n-grams.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># One of 'word', 'char'.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">TOKEN_MODE </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'word'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Minimum document/corpus frequency below which a token will be discarded.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">MIN_DOCUMENT_FREQUENCY </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">ngram_vectorize</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">,</block><block class=" token"> train_labels</block><block class="punctuation token">,</block><block class=" token"> val_texts</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Vectorizes texts as n-gram vectors.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    1 text = 1 tf-idf vector the length of vocabulary of unigrams + bigrams.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        train_texts: list, training text strings.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        train_labels: np.ndarray, training labels.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        val_texts: list, validation text strings.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        x_train, x_val: vectorized training and validation texts</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Create keyword arguments to pass to the 'tf-idf' vectorizer.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    kwargs </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'ngram_range'</block><block class="punctuation token">:</block><block class=" token"> NGRAM_RANGE</block><block class="punctuation token">,</block><block class=" token">  </block><block class="comment token"># Use 1-grams + 2-grams.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'dtype'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'int32'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'strip_accents'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'unicode'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'decode_error'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'replace'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'analyzer'</block><block class="punctuation token">:</block><block class=" token"> TOKEN_MODE</block><block class="punctuation token">,</block><block class=" token">  </block><block class="comment token"># Split text into word tokens.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">'min_df'</block><block class="punctuation token">:</block><block class=" token"> MIN_DOCUMENT_FREQUENCY</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    vectorizer </block><block class="operator token">=</block><block class=" token"> TfidfVectorizer</block><block class="punctuation token">(</block><block class="operator token">**</block><block class=" token">kwargs</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Learn vocabulary from training texts and vectorize training texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train </block><block class="operator token">=</block><block class=" token"> vectorizer</block><block class="punctuation token">.</block><block class=" token">fit_transform</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Vectorize validation texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_val </block><block class="operator token">=</block><block class=" token"> vectorizer</block><block class="punctuation token">.</block><block class=" token">transform</block><block class="punctuation token">(</block><block class=" token">val_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Select top 'k' of the vectorized features.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    selector </block><block class="operator token">=</block><block class=" token"> SelectKBest</block><block class="punctuation token">(</block><block class=" token">f_classif</block><block class="punctuation token">,</block><block class=" token"> k</block><block class="operator token">=</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class=" token">TOP_K</block><block class="punctuation token">,</block><block class=" token"> x_train</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    selector</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">x_train</block><block class="punctuation token">,</block><block class=" token"> train_labels</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train </block><block class="operator token">=</block><block class=" token"> selector</block><block class="punctuation token">.</block><block class=" token">transform</block><block class="punctuation token">(</block><block class=" token">x_train</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">astype</block><block class="punctuation token">(</block><block class="string token">'float32'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_val </block><block class="operator token">=</block><block class=" token"> selector</block><block class="punctuation token">.</block><block class=" token">transform</block><block class="punctuation token">(</block><block class=" token">x_val</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">astype</block><block class="punctuation token">(</block><block class="string token">'float32'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> x_train</block><block class="punctuation token">,</block><block class=" token"> x_val</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">With n-gram vector representation, we discard a lot of information about word order and grammar (</block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3); font-style: italic;">at best, we can maintain some partial ordering information when n &gt; 1</block><block style="background-color: rgba(248, 231, 28, 0.3);">)</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is called a </block><block style="font-weight: bold; color: rgb(208, 2, 27);">bag-of-words approach</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This representation is </block><block style="background-color: rgba(248, 231, 28, 0.3);">used in conjunction with models that dont take ordering into account</block><block>, such as </block><block style="font-weight: bold;">logistic regression</block><block>, </block><block style="font-weight: bold;">multi-layer perceptrons</block><block>, </block><block style="font-weight: bold;">gradient boosting machines</block><block>, </block><block style="font-weight: bold;">support vector machines</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.560929472589341" id="n0.560929472589341" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Sequence Vectors [Option B]</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">For some text samples, </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">word order is critical to the texts meaning</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">For example,</block><block> the sentences, I used to hate my commute. My new bike changed that completely can be understood only when read in order. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Models such as </block><block style="font-weight: bold;">CNNs/RNNs</block><block> can infer meaning from the order of words in a sample. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For these models, we </block><block style="background-color: rgba(248, 231, 28, 0.3);">represent the text as a sequence of tokens, </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">preserving order</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.4258600810601705" id="n0.4258600810601705" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tokenization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Text can be represented as either a </block><block style="background-color: rgba(248, 231, 28, 0.3);">sequence of characters, or a sequence of words</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We have found that using </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">word-level representation provides better performance than character tokens</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is also the general norm that is followed by industry. </block><block style="background-color: rgba(248, 231, 28, 0.3);">Using character tokens makes sense only if texts have lots of typos, which isnt normally the case</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.12295462827015657" id="n0.12295462827015657" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Vectorization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once we have converted our text samples into sequences of words, we need to turn these sequences into numerical vectors. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The example below shows the indexes assigned to the unigrams generated for two texts, and then the sequence of token indexes to which the first text is converted.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Texts</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'The mouse ran up the clock'</block><block class=" token"> and </block><block class="string token">'The mouse ran down'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Index assigned </block><block class="keyword token">for</block><block class=" token"> every token</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">'clock'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">5</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'ran'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'up'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">4</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'down'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">6</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'the'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'mouse'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">}</block><block class="punctuation token">.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="constant token">NOTE</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'the'</block><block class=" token"> occurs most frequently</block><block class="punctuation token">,</block><block class=" token"> so the index value </block><block class="keyword token">of</block><block class=" token"> </block><block class="number token">1</block><block class=" token"> is assigned to it</block><block class="punctuation token">.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Some libraries reserve index </block><block class="number token">0</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> unknown tokens</block><block class="punctuation token">,</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> is the </block><block class="keyword token">case</block><block class=" token"> here</block><block class="punctuation token">.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">Sequence </block><block class="keyword token">of</block><block class=" token"> token indexes</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'The mouse ran up the clock'</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">4</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">5</block><block class="punctuation token">]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are two options available to vectorize the token sequences:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">One-hot encoding:</block><block> Sequences are represented using word vectors in n-dimensional space where </block><block style="font-weight: bold;">n = size of vocabulary</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This representation </block><block style="background-color: rgba(248, 231, 28, 0.3);">works great when we are tokenizing as characters, and the vocabulary is therefore small</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>When we are tokenizing as words, the vocabulary will usually have tens of thousands of tokens, making the one-hot vectors very sparse and inefficient. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="string token">'The mouse ran up the clock'</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(208, 2, 27);">Word embeddings:</block><block> Words have </block><block style="background-color: rgba(248, 231, 28, 0.3);">meaning(s) associated with them</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>As a result, we can represent word tokens in a </block><block style="font-weight: bold;">dense vector space</block><block> (</block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>~</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">~</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>~</mi></mstyle></math></span></compositeblock><block> few hundred real numbers), where the location and </block><block style="background-color: rgba(248, 231, 28, 0.3);">distance between words indicates how similar they are semantically</block><block> (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.8073100923882286"><a href="#n0.8073100923882286" style="color: inherit; text-decoration: inherit;">Figure 6</a></span></compositeblock><block>). This representation is called </block><block style="font-weight: bold;">word embeddings</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 667px; height: 247.46px; position: relative;"><img src="image-resources/7f857a9f-0def-46c1-b0d8-e78e76dc36db.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.8073100923882286" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.8073100923882286"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 59379 --> <!-- /react-text --><!-- react-text: 59380 -->6<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Word embeddings</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Sequence models often have such an embedding layer </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">as their first layer</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This layer </block><block style="background-color: rgba(248, 231, 28, 0.3);">learns to turn word index sequences into word embedding vectors during the training process</block><block>, such that each word index gets mapped to a dense vector of real values representing that words location in semantic space (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.2607750787395935"><a href="#n0.2607750787395935" style="color: inherit; text-decoration: inherit;">Figure 7</a></span></compositeblock><block>).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 648px; height: 261.25px; position: relative;"><img src="image-resources/23c0f031-8b29-475f-b3bd-c7e16019cbc6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.2607750787395935" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.2607750787395935"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 60150 --> <!-- /react-text --><!-- react-text: 60151 -->7<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Embedding layer</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.9698332774588398" id="n0.9698332774588398" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Feature Selection</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Lets put all of the above steps in sequence vectorization together. The following code performs these tasks:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tokenizes the texts into words</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Creates a vocabulary using the top 20,000 tokens</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Converts the tokens into sequence vectors</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold; color: rgb(208, 2, 27);">Pads</block><block style="background-color: rgba(248, 231, 28, 0.3);"> the sequences to a fixed sequence length</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">preprocessing </block><block class="keyword token">import</block><block class=" token"> sequence</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">preprocessing </block><block class="keyword token">import</block><block class=" token"> text</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Vectorization parameters</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Limit on the number of features. We use the top 20K features.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">TOP_K </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">20000</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Limit on the length of text sequences. Sequences longer than this</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># will be truncated.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">MAX_SEQUENCE_LENGTH </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">500</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">sequence_vectorize</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">,</block><block class=" token"> val_texts</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Vectorizes texts as sequence vectors.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    1 text = 1 sequence vector with fixed length.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        train_texts: list, training text strings.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        val_texts: list, validation text strings.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        x_train, x_val, word_index: vectorized training and validation</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            texts and word index dictionary.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Create vocabulary with training texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    tokenizer </block><block class="operator token">=</block><block class=" token"> text</block><block class="punctuation token">.</block><block class=" token">Tokenizer</block><block class="punctuation token">(</block><block class=" token">num_words</block><block class="operator token">=</block><block class=" token">TOP_K</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    tokenizer</block><block class="punctuation token">.</block><block class=" token">fit_on_texts</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Vectorize training and validation texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train </block><block class="operator token">=</block><block class=" token"> tokenizer</block><block class="punctuation token">.</block><block class=" token">texts_to_sequences</block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_val </block><block class="operator token">=</block><block class=" token"> tokenizer</block><block class="punctuation token">.</block><block class=" token">texts_to_sequences</block><block class="punctuation token">(</block><block class=" token">val_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Get max sequence length.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    max_length </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class=" token">x_train</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="builtin token">len</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> max_length </block><block class="operator token">&gt;</block><block class=" token"> MAX_SEQUENCE_LENGTH</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        max_length </block><block class="operator token">=</block><block class=" token"> MAX_SEQUENCE_LENGTH</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Fix sequence length to max value. Sequences shorter than the length are</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># padded in the beginning and sequences longer are truncated</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># at the beginning.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train </block><block class="operator token">=</block><block class=" token"> sequence</block><block class="punctuation token">.</block><block class=" token">pad_sequences</block><block class="punctuation token">(</block><block class=" token">x_train</block><block class="punctuation token">,</block><block class=" token"> maxlen</block><block class="operator token">=</block><block class=" token">max_length</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_val </block><block class="operator token">=</block><block class=" token"> sequence</block><block class="punctuation token">.</block><block class=" token">pad_sequences</block><block class="punctuation token">(</block><block class=" token">x_val</block><block class="punctuation token">,</block><block class=" token"> maxlen</block><block class="operator token">=</block><block class=" token">max_length</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> x_train</block><block class="punctuation token">,</block><block class=" token"> x_val</block><block class="punctuation token">,</block><block class=" token"> tokenizer</block><block class="punctuation token">.</block><block class=" token">word_index</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" style="line-height: 1.4; font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.05050498647346635" id="n0.05050498647346635" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Label vectorization</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can simply convert labels into values in range </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; color: rgb(208, 2, 27); font-weight: bold;">[0, num_classes - 1]</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">For example,</block><block> if there are 3 classes we can just use values 0, 1 and 2 to represent them. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Internally, the network will use one-hot vectors to represent these values</block><block> (to avoid inferring an incorrect relationship between labels). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This representation depends on the loss function and the last-layer activation function we use in our neural network. We will learn more about these in the next section.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.03902828783514489" id="n0.03902828783514489" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Build, Train, and Evaluate Your Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In Step 3, we chose to use either an </block><block style="font-style: italic;">n-gram model</block><block> or </block><block style="font-style: italic;">sequence model</block><block>, using our </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">S/W</block><block> ratio. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now, its time to write our classification algorithm and train it. We will use </block><block class="role-hyper-link" data-hyper-link-url="https://www.tensorflow.org/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=tensorflow" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.tensorflow.org/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=tensorflow" target="_blank" style="color: inherit; text-decoration: inherit;">TensorFlow</a></block><block> with the </block><block class="role-hyper-link" data-hyper-link-url="https://www.tensorflow.org/api_docs/python/tf/keras?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=keras" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.tensorflow.org/api_docs/python/tf/keras?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=keras" target="_blank" style="color: inherit; text-decoration: inherit;">tf.keras</a></block><block> API for this.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Building machine learning models with Keras is all about assembling together layers, data-processing building blocks, much like we would assemble Lego bricks. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>These layers allow us to specify the sequence of transformations we want to perform on our input. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>As our learning algorithm takes in a single text input and outputs a single classification, we can create a linear stack of layers using the </block><block class="role-hyper-link" data-hyper-link-url="https://keras.io/getting-started/sequential-model-guide/" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://keras.io/getting-started/sequential-model-guide/" target="_blank" style="color: inherit; text-decoration: inherit;">Sequential model</a></block><block> API.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The input layer and the intermediate layers will be constructed differently, depending on whether were building an n-gram or a sequence model. </block><block style="background-color: rgba(248, 231, 28, 0.3);">But irrespective of model type, the last layer will be the same for a given problem</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.8389514852267814" id="n0.8389514852267814" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Constructing the Last Layer</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To output such a probability score for binary classification, the activation function of the last layer should be a </block><block style="font-weight: bold; color: rgb(208, 2, 27);">sigmoid function</block><block>, and the loss function used to train the model should be binary </block><block style="font-weight: bold; color: rgb(208, 2, 27);">cross-entropy</block><block> (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.17645408385824113"><a href="#n0.17645408385824113" style="color: inherit; text-decoration: inherit;">Figure 8</a></span></compositeblock><block>, left).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In case of multi-class classification, the activation function of the last layer should be </block><block style="font-weight: bold; color: rgb(208, 2, 27);">softmax</block><block>, and the loss function used to train the model should be </block><block style="color: rgb(208, 2, 27); font-weight: bold;">categorical cross-entropy</block><block>. (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.17645408385824113"><a href="#n0.17645408385824113" style="color: inherit; text-decoration: inherit;">Figure 8</a></span></compositeblock><block>, right).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 594.625px; height: 248.95px; position: relative;"><img src="image-resources/e0fa35e0-fc36-4407-8265-18b333a48a9b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.17645408385824113" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.17645408385824113"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 65298 --> <!-- /react-text --><!-- react-text: 65299 -->8<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Last layer</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following code defines a function that takes the number of classes as input, and outputs the appropriate number of layer units (1 unit for binary classification; otherwise 1 unit for each class) and the appropriate activation function:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">_get_last_layer_units_and_activation</block><block class="punctuation token">(</block><block class=" token">num_classes</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Gets the # units and activation function for the last network layer.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        num_classes: int, number of classes.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        units, activation values.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> num_classes </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        activation </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'sigmoid'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        units </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        activation </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'softmax'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        units </block><block class="operator token">=</block><block class=" token"> num_classes</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> units</block><block class="punctuation token">,</block><block class=" token"> activation</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">When the </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27); background-color: rgba(248, 231, 28, 0.3);">S/W</block><block style="background-color: rgba(248, 231, 28, 0.3);"> ratio is </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">small</block><block style="background-color: rgba(248, 231, 28, 0.3);">, weve found that </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">n-gram models</block><block style="background-color: rgba(248, 231, 28, 0.3);"> perform better than sequence models.</block><block> </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">Sequence models</block><block style="background-color: rgba(248, 231, 28, 0.3);"> are better when there are a </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">large</block><block style="background-color: rgba(248, 231, 28, 0.3);"> number of small, dense vectors.</block><block> </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is because embedding relationships are learned in dense space, and this happens best over many samples.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.338509452800412" id="n0.338509452800412" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Build n-gram model [Option A]</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">We refer to models that process the tokens </block><block style="font-style: italic; background-color: rgba(248, 231, 28, 0.3);">independently</block><block style="background-color: rgba(248, 231, 28, 0.3);"> (not taking into account word order) as </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">n-gram models</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Simple multi-layer perceptrons (including </block><block class="role-hyper-link" data-hyper-link-url="https://developers.google.com/machine-learning/crash-course/logistic-regression/video-lecture?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=mlcc&amp;utm_term=logistic-regression" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://developers.google.com/machine-learning/crash-course/logistic-regression/video-lecture?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=mlcc&amp;utm_term=logistic-regression" target="_blank" style="color: inherit; text-decoration: inherit;">logistic regression</a></block><block>), </block><block class="role-hyper-link" data-hyper-link-url="https://wikipedia.org/wiki/Gradient_boosting" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://wikipedia.org/wiki/Gradient_boosting" target="_blank" style="color: inherit; text-decoration: inherit;">gradient boosting machines</a></block><block> and </block><block class="role-hyper-link" data-hyper-link-url="https://wikipedia.org/wiki/Support_vector_machine" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://wikipedia.org/wiki/Support_vector_machine" target="_blank" style="color: inherit; text-decoration: inherit;">support vector machines</a></block><block> models all fall under this category; </block><block style="background-color: rgba(248, 231, 28, 0.3);">they cannot leverage any information about text ordering</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We compared the performance of some of the n-gram models mentioned above and observed that </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">multi-layer perceptrons (MLPs) typically perform better</block><block style="background-color: rgba(245, 166, 35, 0.2);"> than other options</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>MLPs are simple to define and understand, provide good accuracy, and require relatively little computation.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following code defines a two-layer MLP model in </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">tf.keras</block><block>, adding a couple of </block><block class="role-hyper-link" data-hyper-link-url="https://developers.google.com/machine-learning/glossary/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=dropout-regularization#dropout_regularization" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://developers.google.com/machine-learning/glossary/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=dropout-regularization#dropout_regularization" target="_blank" style="color: inherit; text-decoration: inherit;">Dropout layers for regularization</a></block><block> (to prevent overfitting to training samples).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline-boxed inline"><div style="border-style: solid; border-width: 1px; padding: 1em; margin-top: 0.1em; margin-bottom: 0.1em; border-color: rgb(0, 0, 0); border-radius: 20px;"><editarea class="text-mode"><line class="text-mode indent-0 has-indent list-item" style="line-height: 1.4;"><prefix style="color: rgb(128, 128, 128); font-style: italic; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic; color: rgb(144, 19, 254);">Dropout Regularization:</block><block style="font-style: italic; color: rgb(128, 128, 128);"> A form of regularization useful in training neural networks. Dropout regularization removes a random selection of a fixed number of the units in a network layer for a single gradient step. The more units dropped out, the stronger the regularization. This is analogous to training the network to emulate an exponentially large ensemble of smaller networks.</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras </block><block class="keyword token">import</block><block class=" token"> models</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> Dense</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> Dropout</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">mlp_model</block><block class="punctuation token">(</block><block class=" token">layers</block><block class="punctuation token">,</block><block class=" token"> units</block><block class="punctuation token">,</block><block class=" token"> dropout_rate</block><block class="punctuation token">,</block><block class=" token"> input_shape</block><block class="punctuation token">,</block><block class=" token"> num_classes</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Creates an instance of a multi-layer perceptron model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        layers: int, number of `Dense` layers in the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        units: int, output dimension of the layers.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        dropout_rate: float, percentage of input to drop at Dropout layers.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        input_shape: tuple, shape of input to the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        num_classes: int, number of output classes.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        An MLP model instance.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    op_units</block><block class="punctuation token">,</block><block class=" token"> op_activation </block><block class="operator token">=</block><block class=" token"> _get_last_layer_units_and_activation</block><block class="punctuation token">(</block><block class=" token">num_classes</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model </block><block class="operator token">=</block><block class=" token"> models</block><block class="punctuation token">.</block><block class=" token">Sequential</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dropout</block><block class="punctuation token">(</block><block class=" token">rate</block><block class="operator token">=</block><block class=" token">dropout_rate</block><block class="punctuation token">,</block><block class=" token"> input_shape</block><block class="operator token">=</block><block class=" token">input_shape</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> _ </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">range</block><block class="punctuation token">(</block><block class=" token">layers</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dense</block><block class="punctuation token">(</block><block class=" token">units</block><block class="operator token">=</block><block class=" token">units</block><block class="punctuation token">,</block><block class=" token"> activation</block><block class="operator token">=</block><block class="string token">'relu'</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dropout</block><block class="punctuation token">(</block><block class=" token">rate</block><block class="operator token">=</block><block class=" token">dropout_rate</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dense</block><block class="punctuation token">(</block><block class=" token">units</block><block class="operator token">=</block><block class=" token">op_units</block><block class="punctuation token">,</block><block class=" token"> activation</block><block class="operator token">=</block><block class=" token">op_activation</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> model</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.7059517408126226" id="n0.7059517408126226" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Build sequence model [Option B]</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We refer to models that can learn from the adjacency of tokens as </block><block style="font-weight: bold;">sequence models</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This includes CNN and RNN classes of models. </block><block style="background-color: rgba(248, 231, 28, 0.3);">Data is pre-processed as sequence vectors for these models</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Sequence models generally have a </block><block style="background-color: rgba(248, 231, 28, 0.3);">larger number of parameters to learn</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold;">first layer</block><block> in these models is an </block><block style="font-weight: bold; color: rgb(208, 2, 27);">embedding layer</block><block>, which learns the relationship between the words in a dense vector space. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Learning word relationships works best over many samples</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Words in a given dataset are most likely not unique to that dataset. We can thus learn the relationship between the words in our dataset using other dataset(s). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To do so, </block><block style="background-color: rgba(248, 231, 28, 0.3);">we can transfer an embedding learned from another dataset into our embedding layer</block><block>. These embeddings are referred to as </block><block style="color: rgb(208, 2, 27); font-weight: bold;">pre-trained embeddings</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are pre-trained embeddings available that have been trained using large corpora, such as </block><block class="role-hyper-link" data-hyper-link-url="https://nlp.stanford.edu/projects/glove/" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://nlp.stanford.edu/projects/glove/" target="_blank" style="color: inherit; text-decoration: inherit;">GloVe</a></block><block>. </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">GloVe</block><block> has been trained on multiple corpora (primarily Wikipedia). </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We tested training our sequence models using a version of GloVe embeddings and observed that if we froze the weights of the pre-trained embeddings and trained just the rest of the network, the models did not perform well. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">This could be because the context</block><block> in which the embedding layer was trained might have been </block><block style="background-color: rgba(248, 231, 28, 0.3);">different</block><block> from the context in which we were using it.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">GloVe</block><block> embeddings trained on Wikipedia data may not align with the language patterns in our IMDb dataset. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The relationships inferred may need some updatingi.e., the embedding weights may need </block><block style="font-weight: bold; color: rgb(208, 2, 27);">contextual tuning</block><block>. We do this in two stages:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">In the first run, with the embedding layer weights frozen, we allow the rest of the network to learn</block><block>. At the end of this run, the model weights reach a state that is much better than their uninitialized values. </block><block style="font-weight: bold;">For the second run, we allow the embedding layer to also learn, making fine adjustments to all weights in the network</block><block>. We refer to this process as using a </block><block style="color: rgb(208, 2, 27); font-weight: bold;">fine-tuned embedding</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">Fine-tuned embeddings</block><block style="background-color: rgba(248, 231, 28, 0.3);"> yield better accuracy</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, this comes at the expense of </block><block style="background-color: rgba(248, 231, 28, 0.3);">increased compute power</block><block> required to train the network. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Given a sufficient number of samples, we could do just as well learning an embedding from scratch. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">We observed that for </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27); background-color: rgba(245, 166, 35, 0.2);">S/W &gt; 15K</block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">, starting from scratch effectively yields about the same accuracy as using fine-tuned embedding</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We compared different sequence models such as </block><block style="font-weight: bold;">CNN</block><block>, </block><block style="font-weight: bold;">sepCNN</block><block>, </block><block style="font-weight: bold;">RNN</block><block> (</block><block style="font-weight: bold;">LSTM</block><block> &amp; </block><block style="font-weight: bold;">GRU</block><block>), </block><block style="font-weight: bold;">CNN-RNN</block><block>, and </block><block style="font-weight: bold;">stacked RNN</block><block>, varying the model architectures. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(245, 166, 35, 0.2);">We found that </block><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2); color: rgb(208, 2, 27); text-decoration: underline;" class="role-hyper-link" data-hyper-link-url="https://developers.google.com/machine-learning/glossary?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=sepCNN#depthwise-separable-convolutional-neural-network-sepcnn"><a href="https://developers.google.com/machine-learning/glossary?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=sepCNN#depthwise-separable-convolutional-neural-network-sepcnn" target="_blank" style="color: inherit; text-decoration: inherit;">sepCNNs</a></block><block style="background-color: rgba(245, 166, 35, 0.2);">, a convolutional network variant that is often more data-efficient and compute-efficient, perform better than the other models.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-style: italic; color: rgb(128, 128, 128);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-style: italic; color: rgb(144, 19, 254); font-weight: bold;">Note:</block><block style="font-style: italic; color: rgb(128, 128, 128);"> RNNs are relevant only to a small subset of use-cases. We did not try models like QRNN or RNNs with Attention, as their accuracy improvements would be offset by higher computational costs.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following code constructs a four-layer sepCNN model:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras </block><block class="keyword token">import</block><block class=" token"> models</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras </block><block class="keyword token">import</block><block class=" token"> initializers</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras </block><block class="keyword token">import</block><block class=" token"> regularizers</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> Dense</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> Dropout</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> Embedding</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> SeparableConv1D</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> MaxPooling1D</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow</block><block class="punctuation token">.</block><block class=" token">python</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">layers </block><block class="keyword token">import</block><block class=" token"> GlobalAveragePooling1D</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">sepcnn_model</block><block class="punctuation token">(</block><block class=" token">blocks</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 filters</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 kernel_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 embedding_dim</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 dropout_rate</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 pool_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 input_shape</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 num_classes</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 num_features</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 use_pretrained_embedding</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 is_embedding_trainable</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 embedding_matrix</block><block class="operator token">=</block><block class="boolean token">None</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Creates an instance of a separable CNN model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        blocks: int, number of pairs of sepCNN and pooling blocks in the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        filters: int, output dimension of the layers.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        kernel_size: int, length of the convolution window.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        embedding_dim: int, dimension of the embedding vectors.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        dropout_rate: float, percentage of input to drop at Dropout layers.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        pool_size: int, factor by which to downscale input at MaxPooling layer.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        input_shape: tuple, shape of input to the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        num_classes: int, number of output classes.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        num_features: int, number of words (embedding input dimension).</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        use_pretrained_embedding: bool, true if pre-trained embedding is on.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        is_embedding_trainable: bool, true if embedding layer is trainable.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        embedding_matrix: dict, dictionary with embedding coefficients.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        A sepCNN model instance.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    op_units</block><block class="punctuation token">,</block><block class=" token"> op_activation </block><block class="operator token">=</block><block class=" token"> _get_last_layer_units_and_activation</block><block class="punctuation token">(</block><block class=" token">num_classes</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model </block><block class="operator token">=</block><block class=" token"> models</block><block class="punctuation token">.</block><block class=" token">Sequential</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Add embedding layer. If pre-trained embedding is used add weights to the</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># embeddings layer and set trainable to input is_embedding_trainable flag.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> use_pretrained_embedding</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Embedding</block><block class="punctuation token">(</block><block class=" token">input_dim</block><block class="operator token">=</block><block class=" token">num_features</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            output_dim</block><block class="operator token">=</block><block class=" token">embedding_dim</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            input_length</block><block class="operator token">=</block><block class=" token">input_shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            weights</block><block class="operator token">=</block><block class="punctuation token">[</block><block class=" token">embedding_matrix</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            trainable</block><block class="operator token">=</block><block class=" token">is_embedding_trainable</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Embedding</block><block class="punctuation token">(</block><block class=" token">input_dim</block><block class="operator token">=</block><block class=" token">num_features</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            output_dim</block><block class="operator token">=</block><block class=" token">embedding_dim</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            input_length</block><block class="operator token">=</block><block class=" token">input_shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> _ </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">range</block><block class="punctuation token">(</block><block class=" token">blocks</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dropout</block><block class="punctuation token">(</block><block class=" token">rate</block><block class="operator token">=</block><block class=" token">dropout_rate</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">SeparableConv1D</block><block class="punctuation token">(</block><block class=" token">filters</block><block class="operator token">=</block><block class=" token">filters</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  kernel_size</block><block class="operator token">=</block><block class=" token">kernel_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  activation</block><block class="operator token">=</block><block class="string token">'relu'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  bias_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  depthwise_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  padding</block><block class="operator token">=</block><block class="string token">'same'</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">SeparableConv1D</block><block class="punctuation token">(</block><block class=" token">filters</block><block class="operator token">=</block><block class=" token">filters</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  kernel_size</block><block class="operator token">=</block><block class=" token">kernel_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  activation</block><block class="operator token">=</block><block class="string token">'relu'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  bias_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  depthwise_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  padding</block><block class="operator token">=</block><block class="string token">'same'</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">MaxPooling1D</block><block class="punctuation token">(</block><block class=" token">pool_size</block><block class="operator token">=</block><block class=" token">pool_size</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">SeparableConv1D</block><block class="punctuation token">(</block><block class=" token">filters</block><block class="operator token">=</block><block class=" token">filters </block><block class="operator token">*</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              kernel_size</block><block class="operator token">=</block><block class=" token">kernel_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              activation</block><block class="operator token">=</block><block class="string token">'relu'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              bias_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              depthwise_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              padding</block><block class="operator token">=</block><block class="string token">'same'</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">SeparableConv1D</block><block class="punctuation token">(</block><block class=" token">filters</block><block class="operator token">=</block><block class=" token">filters </block><block class="operator token">*</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              kernel_size</block><block class="operator token">=</block><block class=" token">kernel_size</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              activation</block><block class="operator token">=</block><block class="string token">'relu'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              bias_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              depthwise_initializer</block><block class="operator token">=</block><block class="string token">'random_uniform'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                              padding</block><block class="operator token">=</block><block class="string token">'same'</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">GlobalAveragePooling1D</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dropout</block><block class="punctuation token">(</block><block class=" token">rate</block><block class="operator token">=</block><block class=" token">dropout_rate</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">add</block><block class="punctuation token">(</block><block class=" token">Dense</block><block class="punctuation token">(</block><block class=" token">op_units</block><block class="punctuation token">,</block><block class=" token"> activation</block><block class="operator token">=</block><block class=" token">op_activation</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> model</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.17677525581721" id="n0.17677525581721" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Train Your Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are three key parameters to be chosen for this process (See </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.8294520066411206"><a href="#n0.8294520066411206" style="color: inherit; text-decoration: inherit;">Table 2</a></span></compositeblock><block>).</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Metric:</block><block> How to measure the performance of our model using a metric. We used </block><block class="role-hyper-link" data-hyper-link-url="https://developers.google.com/machine-learning/glossary/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=accuracy#accuracy" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://developers.google.com/machine-learning/glossary/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=glossary&amp;utm_term=accuracy#accuracy" target="_blank" style="color: inherit; text-decoration: inherit;">accuracy</a></block><block> as the metric in our experiments.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Loss function:</block><block> A function that is used to calculate a loss value that the training process then attempts to minimize by tuning the network weights. For classification problems, </block><block style="font-weight: bold;">cross-entropy</block><block> loss works well.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Optimizer:</block><block> A function that decides how the network weights will be updated based on the output of the loss function. We used the popular </block><block class="role-hyper-link" data-hyper-link-url="https://arxiv.org/abs/1412.6980" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://arxiv.org/abs/1412.6980" target="_blank" style="color: inherit; text-decoration: inherit;">Adam</a></block><block> optimizer in our experiments.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In Keras, we can pass these learning parameters to a model using the </block><block class="role-hyper-link" data-hyper-link-url="https://keras.io/getting-started/sequential-model-guide/#compilation" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://keras.io/getting-started/sequential-model-guide/#compilation" target="_blank" style="color: inherit; text-decoration: inherit;">compile</a></block><block> method.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 703.25px; height: 173.4px; position: relative;"><img src="image-resources/eb3d91ee-74b9-4766-b640-fa729d25df7f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.8294520066411206" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.8294520066411206"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span>Table 2</span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Learning parameters</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The actual training happens using the fit method. Depending on the size of your dataset, this is the method in which most compute cycles will be spent. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In each training iteration, </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">batch_size</block><block> number of samples from your training data are used to compute the loss, and the weights are updated once, based on this value. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The training process completes an </block><block style="color: rgb(208, 2, 27); font-weight: bold;">epoch</block><block> once the model has seen the entire training dataset. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>At the end of each </block><block style="font-weight: bold;">epoch</block><block>, we use the validation dataset to evaluate how well the model is learning. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We repeat training using the dataset for a </block><block style="background-color: rgba(248, 231, 28, 0.3);">predetermined number of epochs</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We may optimize this by </block><block style="font-weight: bold; color: rgb(208, 2, 27);">stopping early</block><block>, when the </block><block style="background-color: rgba(248, 231, 28, 0.3);">validation accuracy stabilizes between consecutive epochs, showing that the model is not training anymore</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 694px; height: 168.36px; position: relative;"><img src="image-resources/cfb65086-085e-4033-b98d-d3e66ba39c9e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.5598229698902473" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.5598229698902473"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span>Table 3</span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block>Training hyperparameters</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following Keras code implements the training process using the parameters chosen in the </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.8294520066411206"><a href="#n0.8294520066411206" style="color: inherit; text-decoration: inherit;">Table 2</a></span></compositeblock><block> &amp; </block><compositeblock dir="ltr" class="inline"><span class="image-caption-ref" data-caption-ref-id="n0.5598229698902473"><a href="#n0.5598229698902473" style="color: inherit; text-decoration: inherit;">Table 3</a></span></compositeblock><block> above. Please find code examples for training the sequence model </block><block class="role-hyper-link" data-hyper-link-url="https://github.com/alibakh62/eng-edu/tree/main/ml/guides/text_classification" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://github.com/alibakh62/eng-edu/tree/main/ml/guides/text_classification" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 14px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">train_ngram_model</block><block class="punctuation token">(</block><block class=" token">data</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      learning_rate</block><block class="operator token">=</block><block class="number token">1e</block><block class="operator token">-</block><block class="number token">3</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      epochs</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      batch_size</block><block class="operator token">=</block><block class="number token">128</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      layers</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      units</block><block class="operator token">=</block><block class="number token">64</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      dropout_rate</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Trains n-gram model on the given dataset.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        data: tuples of training and test texts and labels.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        learning_rate: float, learning rate for training model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        epochs: int, number of epochs.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        batch_size: int, number of samples per batch.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        layers: int, number of `Dense` layers in the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        units: int, output dimension of Dense layers in the model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        dropout_rate: float: percentage of input to drop at Dropout layers.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Raises</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ValueError: If validation data has label values which were not seen</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            in the training data.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Get the data.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class=" token">train_texts</block><block class="punctuation token">,</block><block class=" token"> train_labels</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">val_texts</block><block class="punctuation token">,</block><block class=" token"> val_labels</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> data</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Verify that validation labels are in the same range as training labels.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    num_classes </block><block class="operator token">=</block><block class=" token"> explore_data</block><block class="punctuation token">.</block><block class=" token">get_num_classes</block><block class="punctuation token">(</block><block class=" token">train_labels</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    unexpected_labels </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">v </block><block class="keyword token">for</block><block class=" token"> v </block><block class="keyword token">in</block><block class=" token"> val_labels </block><block class="keyword token">if</block><block class=" token"> v </block><block class="keyword token">not</block><block class=" token"> </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">range</block><block class="punctuation token">(</block><block class=" token">num_classes</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">unexpected_labels</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">raise</block><block class=" token"> ValueError</block><block class="punctuation token">(</block><block class="string token">'Unexpected label values found in the validation set:'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         </block><block class="string token">' {unexpected_labels}. Please make sure that the '</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         </block><block class="string token">'labels in the validation set are in the same range '</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         </block><block class="string token">'as training labels.'</block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             unexpected_labels</block><block class="operator token">=</block><block class=" token">unexpected_labels</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Vectorize texts.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train</block><block class="punctuation token">,</block><block class=" token"> x_val </block><block class="operator token">=</block><block class=" token"> vectorize_data</block><block class="punctuation token">.</block><block class=" token">ngram_vectorize</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        train_texts</block><block class="punctuation token">,</block><block class=" token"> train_labels</block><block class="punctuation token">,</block><block class=" token"> val_texts</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Create model instance.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model </block><block class="operator token">=</block><block class=" token"> build_model</block><block class="punctuation token">.</block><block class=" token">mlp_model</block><block class="punctuation token">(</block><block class=" token">layers</block><block class="operator token">=</block><block class=" token">layers</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  units</block><block class="operator token">=</block><block class=" token">units</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  dropout_rate</block><block class="operator token">=</block><block class=" token">dropout_rate</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  input_shape</block><block class="operator token">=</block><block class=" token">x_train</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">:</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  num_classes</block><block class="operator token">=</block><block class=" token">num_classes</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Compile model with learning parameters.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> num_classes </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        loss </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'binary_crossentropy'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        loss </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'sparse_categorical_crossentropy'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    optimizer </block><block class="operator token">=</block><block class=" token"> tf</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">optimizers</block><block class="punctuation token">.</block><block class=" token">Adam</block><block class="punctuation token">(</block><block class=" token">lr</block><block class="operator token">=</block><block class=" token">learning_rate</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class="builtin token">compile</block><block class="punctuation token">(</block><block class=" token">optimizer</block><block class="operator token">=</block><block class=" token">optimizer</block><block class="punctuation token">,</block><block class=" token"> loss</block><block class="operator token">=</block><block class=" token">loss</block><block class="punctuation token">,</block><block class=" token"> metrics</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">'acc'</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Create callback for early stopping on validation loss. If the loss does</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># not decrease in two consecutive tries, stop training.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    callbacks </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">tf</block><block class="punctuation token">.</block><block class=" token">keras</block><block class="punctuation token">.</block><block class=" token">callbacks</block><block class="punctuation token">.</block><block class=" token">EarlyStopping</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        monitor</block><block class="operator token">=</block><block class="string token">'val_loss'</block><block class="punctuation token">,</block><block class=" token"> patience</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Train and validate model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    history </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            x_train</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            train_labels</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            epochs</block><block class="operator token">=</block><block class=" token">epochs</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            callbacks</block><block class="operator token">=</block><block class=" token">callbacks</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            validation_data</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">x_val</block><block class="punctuation token">,</block><block class=" token"> val_labels</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            verbose</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">,</block><block class=" token">  </block><block class="comment token"># Logs once per epoch.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            batch_size</block><block class="operator token">=</block><block class=" token">batch_size</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Print results.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    history </block><block class="operator token">=</block><block class=" token"> history</block><block class="punctuation token">.</block><block class=" token">history</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">'Validation accuracy: {acc}, loss: {loss}'</block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            acc</block><block class="operator token">=</block><block class=" token">history</block><block class="punctuation token">[</block><block class="string token">'val_acc'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> loss</block><block class="operator token">=</block><block class=" token">history</block><block class="punctuation token">[</block><block class="string token">'val_loss'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Save model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="punctuation token">.</block><block class=" token">save</block><block class="punctuation token">(</block><block class="string token">'IMDb_mlp_model.h5'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> history</block><block class="punctuation token">[</block><block class="string token">'val_acc'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> history</block><block class="punctuation token">[</block><block class="string token">'val_loss'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.6843902676744793" id="n0.6843902676744793" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tune Hyperparameters</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We had to choose a number of hyperparameters for defining and training the model. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We relied on intuition, examples and best practice recommendations. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Our first choice of hyperparameter values, however, may not yield the best results. It only gives us a good starting point for training. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Every problem is different and tuning these hyperparameters will help refine our model to better represent the particularities of the problem at hand</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Lets take a look at some of the hyperparameters we used and what it means to tune them:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of layers in the model:</block><block> The number of layers in a neural network is an indicator of its </block><block style="font-weight: bold;">complexity</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">We must be careful in choosing this value</block><block>: </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Too many layers will allow the model to learn too much information about the training data, causing </block><block style="font-weight: bold;">overfitting</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Too few layers can limit the models learning ability, causing </block><block style="font-weight: bold;">underfitting</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For text classification datasets, we experimented with one, two, and three-layer MLPs. Models with two layers performed well, and in some cases better than three-layer models. Similarly, we tried sepCNNs with four and six layers, and the four-layer models performed well.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Number of units per layer:</block><block> The units in a layer must hold the information for the transformation that a layer performs. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For the </block><block style="font-weight: bold;">first layer</block><block>, this is </block><block style="background-color: rgba(248, 231, 28, 0.3);">driven by the number of features</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>In subsequent layers, the number of units depends on the </block><block style="background-color: rgba(248, 231, 28, 0.3);">choice of expanding or contracting the representation from the previous layer</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">Try to </block><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">minimize the information loss</block><block style="background-color: rgba(248, 231, 28, 0.3);"> between layers</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>We tried unit values in the range [8, 16, 32, 64], and 32/64 units worked well.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Dropout rate:</block><block> Dropout layers are used in the model for </block><block style="font-weight: bold;">regularization</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>They define the fraction of input to drop as a precaution for overfitting. </block><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">Recommended range: 0.20.5</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Learning rate:</block><block> This is the rate at which the neural network weights change between iterations. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>A large learning rate may cause large swings in the weights, and we may never find their optimal values. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>A low learning rate is good, but the model will take more iterations to converge. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgba(248, 231, 28, 0.3);">It is a good idea to start low, say at 1e-4. If the training is very slow, increase this value</block><block>. If your model is not learning, try decreasing learning rate.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are couple of additional hyperparameters we tuned that are specific to our sepCNN model:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Kernel size:</block><block> The size of the convolution window. </block><block style="background-color: rgba(248, 231, 28, 0.3); font-weight: bold;">Recommended values: 3 or 5</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(245, 166, 35, 0.2);">Embedding dimensions:</block><block> The number of dimensions we want to use to represent word embeddingsi.e., the size of each word vector. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgba(248, 231, 28, 0.3);">Recommended values: 50300</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>In our experiments, we used </block><block style="font-weight: bold;">GloVe</block><block> embeddings with 200 dimensions with a pre-trained embedding layer.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.1976119444091633" id="n0.1976119444091633" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">8. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deploy Your Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can train, tune and deploy machine learning models on Google Cloud. See the following resources for guidance on deploying your model to production:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://blog.keras.io/keras-as-a-simplified-interface-to-tensorflow-tutorial.html#exporting-a-model-with-tensorflow-serving" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://blog.keras.io/keras-as-a-simplified-interface-to-tensorflow-tutorial.html#exporting-a-model-with-tensorflow-serving" target="_blank" style="color: inherit; text-decoration: inherit;">Tutorial</a></block><block> on how to export a Keras model with TensorFlow serving.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>TensorFlow serving </block><block class="role-hyper-link" data-hyper-link-url="https://www.tensorflow.org/tfx/guide/serving?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=documentation" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.tensorflow.org/tfx/guide/serving?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=tensorflow&amp;utm_term=documentation" target="_blank" style="color: inherit; text-decoration: inherit;">documentation</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://cloud.google.com/ai-platform/docs?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=cloud&amp;utm_term=guide" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://cloud.google.com/ai-platform/docs?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=cloud&amp;utm_term=guide" target="_blank" style="color: inherit; text-decoration: inherit;">Guide</a></block><block> to training and deploying your model on Google Cloud.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Please keep in mind the following key things when deploying your model:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Make sure your production data </block><block class="role-hyper-link" data-hyper-link-url="https://developers.google.com/machine-learning/guides/rules-of-ml/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=rules-of-ml&amp;utm_term=distribution#training-serving_skew" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://developers.google.com/machine-learning/guides/rules-of-ml/?utm_source=DevSite&amp;utm_campaign=Text-Class-Guide&amp;utm_medium=referral&amp;utm_content=rules-of-ml&amp;utm_term=distribution#training-serving_skew" target="_blank" style="color: inherit; text-decoration: inherit;">follows the same distribution</a></block><block> as your training and evaluation data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Regularly re-evaluate by collecting more training data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If your data distribution changes, retrain your model.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="boxed-container inline" style="display: block;"><div style="border-style: solid; border-width: 1px; padding: 1em; margin-top: 0.1em; margin-bottom: 0.1em; border-color: transparent; border-radius: 20px; background: rgba(155, 155, 155, 0.2);"><editarea class="text-mode"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold; font-size: 1.2em;">Exporting a model with TensorFlow-serving</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">TensorFlow Serving is a library for serving TensorFlow models in a production setting, developed by Google.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Any Keras model can be exported with TensorFlow-serving (as long as it only has one input and one output, which is a limitation of TF-serving), whether or not it was training as part of a TensorFlow workflow. In fact you could even train your Keras model with Theano then switch to the TensorFlow Keras backend and export your model.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Here's how it works.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">If your graph makes use of the Keras learning phase (different behavior at training time and test time), the very first thing to do before exporting your model is to hard-code the value of the learning phase (as 0, presumably, i.e. test mode) into your graph. This is done by 1) registering a constant learning phase with the Keras backend, and 2) re-building your model afterwards.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Here are these two simple steps in action:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> keras </block><block class="keyword token">import</block><block class=" token"> backend </block><block class="keyword token">as</block><block class=" token"> K</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">K</block><block class="punctuation token">.</block><block class=" token">set_learning_phase</block><block class="punctuation token">(</block><block class="number token">0</block><block class="punctuation token">)</block><block class=" token">  </block><block class="comment token"># all new operations will be in test mode from now on</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># serialize the model and get its weights, for quick re-building</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">config </block><block class="operator token">=</block><block class=" token"> previous_model</block><block class="punctuation token">.</block><block class=" token">get_config</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">weights </block><block class="operator token">=</block><block class=" token"> previous_model</block><block class="punctuation token">.</block><block class=" token">get_weights</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># re-build a model where the learning phase is now hard-coded to 0</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> keras</block><block class="punctuation token">.</block><block class=" token">models </block><block class="keyword token">import</block><block class=" token"> model_from_config</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">new_model </block><block class="operator token">=</block><block class=" token"> model_from_config</block><block class="punctuation token">(</block><block class=" token">config</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">new_model</block><block class="punctuation token">.</block><block class=" token">set_weights</block><block class="punctuation token">(</block><block class=" token">weights</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">We can now use TensorFlow-serving to export the model, following the instructions found in the </block><block class="role-hyper-link" data-hyper-link-url="https://github.com/tensorflow/serving/blob/master/tensorflow_serving/g3doc/serving_basic.md" style="text-decoration: underline; color: rgb(17, 85, 204); font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="https://github.com/tensorflow/serving/blob/master/tensorflow_serving/g3doc/serving_basic.md" target="_blank" style="color: inherit; text-decoration: inherit;">official tutorial</a></block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">:</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> tensorflow_serving</block><block class="punctuation token">.</block><block class=" token">session_bundle </block><block class="keyword token">import</block><block class=" token"> exporter</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">export_path </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class=" token"> </block><block class="comment token"># where to save the exported graph</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">export_version </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class=" token"> </block><block class="comment token"># version number (integer)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">saver </block><block class="operator token">=</block><block class=" token"> tf</block><block class="punctuation token">.</block><block class=" token">train</block><block class="punctuation token">.</block><block class=" token">Saver</block><block class="punctuation token">(</block><block class=" token">sharded</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_exporter </block><block class="operator token">=</block><block class=" token"> exporter</block><block class="punctuation token">.</block><block class=" token">Exporter</block><block class="punctuation token">(</block><block class=" token">saver</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature </block><block class="operator token">=</block><block class=" token"> exporter</block><block class="punctuation token">.</block><block class=" token">classification_signature</block><block class="punctuation token">(</block><block class=" token">input_tensor</block><block class="operator token">=</block><block class=" token">model</block><block class="punctuation token">.</block><block class="builtin token">input</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                              scores_tensor</block><block class="operator token">=</block><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">output</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_exporter</block><block class="punctuation token">.</block><block class=" token">init</block><block class="punctuation token">(</block><block class=" token">sess</block><block class="punctuation token">.</block><block class=" token">graph</block><block class="punctuation token">.</block><block class=" token">as_graph_def</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    default_graph_signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_exporter</block><block class="punctuation token">.</block><block class=" token">export</block><block class="punctuation token">(</block><block class=" token">export_path</block><block class="punctuation token">,</block><block class=" token"> tf</block><block class="punctuation token">.</block><block class=" token">constant</block><block class="punctuation token">(</block><block class=" token">export_version</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> sess</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.2em; font-weight: bold;">Batch Training</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">Very large datasets may not fit in the memory allocated to your process. In the previous steps, we have set up a pipeline where we bring in the entire dataset in to the memory, prepare the data, and pass the working set to the training function. Instead, Keras provides an alternative training function (</block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">fit_generator</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">) that pulls the data in batches. This allows us to apply the transformations in the data pipeline to only a small (a multiple of </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">batch_size</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">) part of the data. During our experiments, we used batching (code in GitHub) for datasets such as </block><block style="font-style: italic; font-family: &quot;Computer Modern Serif&quot;, serif;">DBPedia, Amazon reviews, Ag news, and Yelp reviews</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">The following code illustrates how to generate data batches and feed them to </block><block style="font-family: &quot;Computer Modern Typewriter&quot;, serif; font-weight: bold; color: rgb(208, 2, 27);">fit_generator</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif;">.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-tomorrow-night" style="display: block; border: 1px solid lightgray; background: rgb(45, 45, 45); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">_data_generator</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">,</block><block class=" token"> y</block><block class="punctuation token">,</block><block class=" token"> num_features</block><block class="punctuation token">,</block><block class=" token"> batch_size</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Generates batches of vectorized texts for training/validation.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Arguments</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        x: np.matrix, feature matrix.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        y: np.ndarray, labels.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        num_features: int, number of features.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        batch_size: int, number of samples per batch.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    # Returns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Yields feature and label data in batches.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    num_samples </block><block class="operator token">=</block><block class=" token"> x</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    num_batches </block><block class="operator token">=</block><block class=" token"> num_samples </block><block class="operator token">//</block><block class=" token"> batch_size</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> num_samples </block><block class="operator token">%</block><block class=" token"> batch_size</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        num_batches </block><block class="operator token">+=</block><block class=" token"> </block><block class="number token">1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">while</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> i </block><block class="keyword token">in</block><block class=" token"> </block><block class="builtin token">range</block><block class="punctuation token">(</block><block class=" token">num_batches</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            start_idx </block><block class="operator token">=</block><block class=" token"> i </block><block class="operator token">*</block><block class=" token"> batch_size</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            end_idx </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">i </block><block class="operator token">+</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> batch_size</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> end_idx </block><block class="operator token">&gt;</block><block class=" token"> num_samples</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                end_idx </block><block class="operator token">=</block><block class=" token"> num_samples</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            x_batch </block><block class="operator token">=</block><block class=" token"> x</block><block class="punctuation token">[</block><block class=" token">start_idx</block><block class="punctuation token">:</block><block class=" token">end_idx</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            y_batch </block><block class="operator token">=</block><block class=" token"> y</block><block class="punctuation token">[</block><block class=" token">start_idx</block><block class="punctuation token">:</block><block class=" token">end_idx</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">yield</block><block class=" token"> x_batch</block><block class="punctuation token">,</block><block class=" token"> y_batch</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create training and validation generators.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">training_generator </block><block class="operator token">=</block><block class=" token"> _data_generator</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_train</block><block class="punctuation token">,</block><block class=" token"> train_labels</block><block class="punctuation token">,</block><block class=" token"> num_features</block><block class="punctuation token">,</block><block class=" token"> batch_size</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">validation_generator </block><block class="operator token">=</block><block class=" token"> _data_generator</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    x_val</block><block class="punctuation token">,</block><block class=" token"> val_labels</block><block class="punctuation token">,</block><block class=" token"> num_features</block><block class="punctuation token">,</block><block class=" token"> batch_size</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Get number of training steps. This indicated the number of steps it takes</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># to cover all samples in one epoch.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">steps_per_epoch </block><block class="operator token">=</block><block class=" token"> x_train</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">//</block><block class=" token"> batch_size</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">if</block><block class=" token"> x_train</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">%</block><block class=" token"> batch_size</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    steps_per_epoch </block><block class="operator token">+=</block><block class=" token"> </block><block class="number token">1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Get number of validation steps.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">validation_steps </block><block class="operator token">=</block><block class=" token"> x_val</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">//</block><block class=" token"> batch_size</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">if</block><block class=" token"> x_val</block><block class="punctuation token">.</block><block class=" token">shape</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">%</block><block class=" token"> batch_size</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    validation_steps </block><block class="operator token">+=</block><block class=" token"> </block><block class="number token">1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train and validate model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">history </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">fit_generator</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    generator</block><block class="operator token">=</block><block class=" token">training_generator</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    steps_per_epoch</block><block class="operator token">=</block><block class=" token">steps_per_epoch</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    validation_data</block><block class="operator token">=</block><block class=" token">validation_generator</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    validation_steps</block><block class="operator token">=</block><block class=" token">validation_steps</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    callbacks</block><block class="operator token">=</block><block class=" token">callbacks</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    epochs</block><block class="operator token">=</block><block class=" token">epochs</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    verbose</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block><block class=" token">  </block><block class="comment token"># Logs once per epoch.</block></blocks></line></editarea></div></compositeblock></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode selected" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; color: rgb(245, 166, 35); stroke: rgb(245, 166, 35); border-color: rgb(245, 166, 35); fill: rgb(245, 166, 35);"><a href="#n0.3033023006773121" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock></blocks></line></area-container></editarea><div></div></math-edit-container></math-type></editor-container></body></html>